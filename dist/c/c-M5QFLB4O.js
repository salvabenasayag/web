import{b as Wn,c as Rr,d as eo,e as Or}from"https://st-p.rmcdn1.net/bb5ea210/dist/c/c-YFHFYU7S.js";import{a as Ae,b as no}from"https://st-p.rmcdn1.net/bb5ea210/dist/c/c-BYNJQAZL.js";import{b as $n,c as wt,d as zn,e as Vn,f as Yn,h as Gn,i as Jn}from"https://st-p.rmcdn1.net/bb5ea210/dist/c/c-HCDLG3QF.js";import{a as qn,b as Xn,c as Zn,d as Qn,f as tt,g as ve,i as nt}from"https://st-p.rmcdn1.net/bb5ea210/dist/c/c-GCY7V35C.js";import{a as oo,b as _r}from"https://st-p.rmcdn1.net/bb5ea210/dist/c/c-B7IFCBAD.js";import{r as io,u as Dr}from"https://st-p.rmcdn1.net/bb5ea210/dist/c/c-W5GHORJY.js";import{b as so,d as Mr}from"https://st-p.rmcdn1.net/bb5ea210/dist/c/c-VYBW56Q7.js";import{$a as et,$b as Nn,Ba as Qe,Ca as kn,Cb as Et,Ea as En,F as Ge,Fb as vt,H as on,Hb as ye,Ia as vn,K as rn,Kb as K,L as sn,Na as Pr,O as ht,Oa as wn,P as Oe,Q as Je,Qa as Ir,Tb as An,U as ln,Ub as Mn,V as Ce,Va as be,Vb as Dn,W as St,Wa as Pn,Wb as Un,Z as an,Zb as Bn,_ as cn,_a as In,_b as Hn,a as hr,aa as dn,ac as Kn,b as Sr,bb as Rn,c as xr,ca as qe,ea as xt,f as Ye,fa as Tt,ga as un,gb as _e,ha as fn,hb as On,i as Tr,ia as pn,ib as ke,j as V,k as en,ka as Ct,la as mn,lc as ce,m as Re,ma as gn,na as br,nc as jn,oa as Xe,oc as fe,pa as yn,pb as Fn,qa as bt,sa as hn,sb as Ln,tb as kt,ua as Er,ub as _n,va as Fe,w as nn,x as Te,xa as Sn}from"https://st-p.rmcdn1.net/bb5ea210/dist/c/c-UPGAECPZ.js";import{i as kr}from"https://st-p.rmcdn1.net/bb5ea210/dist/c/c-YHWQFOQU.js";import{f as tn,x as Cr}from"https://st-p.rmcdn1.net/bb5ea210/dist/c/c-3KHETOCD.js";import{a as Le,g as bn}from"https://st-p.rmcdn1.net/bb5ea210/dist/c/c-O4ZZWP2U.js";import{a as Pt,b as Ur}from"https://st-p.rmcdn1.net/bb5ea210/dist/c/c-VVQK342Z.js";import{a as ro,b as Ar}from"https://st-p.rmcdn1.net/bb5ea210/dist/c/c-LIUMUAMP.js";import{a as to,b as Fr}from"https://st-p.rmcdn1.net/bb5ea210/dist/c/c-ZN5FYFIE.js";import{a as Lr}from"https://st-p.rmcdn1.net/bb5ea210/dist/c/c-6PM2BXDY.js";import{a as O,d as Ee}from"https://st-p.rmcdn1.net/bb5ea210/dist/c/c-NRBJ4WPE.js";import{a as Jt,b as yr}from"https://st-p.rmcdn1.net/bb5ea210/dist/c/c-ZJC5GDGC.js";import{r as xe,v as Ve}from"https://st-p.rmcdn1.net/bb5ea210/dist/c/c-QYGQR2I3.js";import{a as Qt,h as Ze,i as Cn}from"https://st-p.rmcdn1.net/bb5ea210/dist/c/c-GA4DPJVF.js";import{c as xn,d as vr,h as Tn,j as wr}from"https://st-p.rmcdn1.net/bb5ea210/dist/c/c-HWHCYD2L.js";import{c as Xt,e as Zt}from"https://st-p.rmcdn1.net/bb5ea210/dist/c/c-XS2VTMON.js";import{C as ge,D as h,E as z,F as ne,d as $e,e as qt,u as ze}from"https://st-p.rmcdn1.net/bb5ea210/dist/c/c-GXGN7WTM.js";import{a as ae}from"https://st-p.rmcdn1.net/bb5ea210/dist/c/c-QDYTPFQ4.js";import{n as zt,o as mr}from"https://st-p.rmcdn1.net/bb5ea210/dist/c/c-D5H7EYNT.js";import{A as Vt,B as Yt,C as Gt,p as yt}from"https://st-p.rmcdn1.net/bb5ea210/dist/c/c-UHM3TZXV.js";import{b as gr}from"https://st-p.rmcdn1.net/bb5ea210/dist/c/c-S7MQREXB.js";import{a as L,d as H}from"https://st-p.rmcdn1.net/bb5ea210/dist/c/c-MXCJJCFW.js";var It,lo=L(()=>{"use strict";Te();Je();St();fe();Mr();It=({editorState:e,method:n})=>{let o=K(e,"LETTER_SPACING"),t=o&&o.length?parseFloat(o[0]):0,r=ce({editorState:e}),i=on()||{project:[],global:[]},l=[...i.project,...i.global].find(d=>d.name===r),m=!!r&&Ce(l?.cssProperties.letterSpacing,!0),p=t||m||0,a=n==="decrease"?-1:1;return ye({key:"LETTER_SPACING",value:so(p+.2*a,2),editorState:e})}});var Rt,ao=L(()=>{"use strict";Te();Re();fe();Rt=({editorState:e,method:n})=>{let o=K(e,"FONT_SIZE"),t=o&&o.length?parseInt(o[0]):V.fontSize,r=n==="decrease"?-1:1;return ye({key:"FONT_SIZE",value:t+r,editorState:e})}});function Me(e){return!e.isFolder}function co(e){return!!e.isFolder}function Is({all:e,allProjects:n,excluded:o,selectedUser:t,me:r}){let s=(o||[]).map(i=>i._id);return t&&typeof t=="object"&&t._id&&s.push(t._id),e.reduce((i,l)=>{if(l.email===r.email||l.isSupport)return i;let m=Hr(l,n)+Nr(l.folderIds||[],n).length,p={...l,projectsCount:m},a=i.map(u=>u._id);return!l.isPending&&!l.isSupport&&![...s,...a].includes(l._id)?[...i,p]:i},[])}function Br(e){return e.reduce((n,o)=>Me(o)?[...n,o.num_id]:n,[])}function Rs(e){return e.reduce((n,o)=>co(o)?[...n,o._id]:n,[])}function Hr(e,n){let o=Br(n);return e.projects?e.projects.filter(t=>!t.isArchived).length:e.sharesAll?n.length:e.projectNumIds.filter(t=>o.includes(t)).length}function Os({projects:e,allTeammates:n,me:o}){return e.length?n.filter(t=>t.email===o.email?!1:!t.projects&&(t.sharesAll&&e.every(r=>Me(r))||e.every(r=>Me(r)&&(t.projectNumIds||[]).includes(r.num_id)||Me(r)&&!!r.folder&&(t.folderIds||[]).includes(r.folder)||co(r)&&(t.folderIds||[]).includes(r._id)))):[]}function Fs(e,n={}){let o=e.projectNumIds?[...e.myTeam,...e.sharedTeam].filter(r=>yt(e.projectNumIds,r.projectNumIds).length>0||yt(e.folderIds,r.folderIds).length>0||n.excludeSupport&&!r.isSupport):[...e.myTeam,...e.sharedTeam],t=Yt(o,"email");return t.map(r=>{if(!r.isPending)return r;let s=t.find(i=>i.email===r.email&&i._id!==r._id);return s?{...r,name:s.name,pic:s.pic}:r})}function Nr(e,n){return e?n.filter(o=>Me(o)&&o.folder&&e.includes(o.folder)).map(o=>o.num_id):[]}function Ls(e){return e&&e.plan_limits&&e.plan_limits.contributors||0}function _s(e){return e.filter(n=>n.sharesAll||n.projectNumIds&&n.projectNumIds.length||n.folderIds&&n.folderIds.length)}function uo({projectNumId:e,projectFolderId:n,folderId:o,teammate:t}){return typeof e=="number"&&t.projectRoles?.hasOwnProperty(e)?t.projectRoles[e]:typeof o=="string"&&t.folderRoles?.hasOwnProperty(o)?t.folderRoles[o]:typeof n=="string"&&t.folderRoles?.hasOwnProperty(n)?t.folderRoles[n]:null}function As({items:e=[],roles:n={},newItems:o,newRole:t}){let r={},s=[];for(let i of e)n.hasOwnProperty(i)&&(r[i]=n[i],s.push(i));if(t&&o?.length)for(let i of o)r[i]=t,s.includes(i)||s.push(i);return{roles:r,items:s}}var fo=L(()=>{"use strict";Gt()});var po,pe,Ot=L(()=>{"use strict";fo();po="projectRoles",pe={rolesList:[{name:"member",description:"Layout unlocked"},{name:"editor",description:"Layout locked",secondaryDescription:"Enables non-designers to make changes safely"}],isPermissionAllowed(e){return window.RM?.constructorRouter?.mag?.isPermissionAllowed?.(e)??!0},checkSelfRoleChanged({teammate:e,isOwner:n,projectNumId:o,userEmail:t,team:r}){if(n&&e.email===t){let s=e.projectRoles?.[o],i=r?.find(l=>l.email===t)?.projectRoles?.[o];return s!==i}return!1},getRoleForProject({team:e,projectNumId:n,userEmail:o}){let t=e.find(r=>r.email===o);if(t){let r=uo({teammate:t,projectNumId:n});if(r)return r}return null},getCurrentRole(){return window.RM?.constructorRouter?.mag?.roleName??"member"},getAllProjectRoles(){let e={};try{let n=sessionStorage.getItem(po);e=n?JSON.parse(n):{}}catch(n){console.log(n)}return e},saveProjectRole(e,n){try{let o=pe.getAllProjectRoles();o[e]=n,sessionStorage.setItem(po,JSON.stringify(o))}catch(o){console.log(o)}},getCurrentProjectRole(e){return pe.getAllProjectRoles()[e]||"member"},getRoleForAnalytics(e){let n=pe.getCurrentRole();return e?"owner":n==="editor"?"collaborator_locked_layout":"collaborator_unlocked_layout"}}});var mo=L(()=>{"use strict"});var De=L(()=>{"use strict"});var go=L(()=>{"use strict"});var Ue,Ft=L(()=>{"use strict";Ue={COUNT_OF_ACTIONS_IN_PROJECT:"rm_count_of_actions_in_project"}});var yo,ho=L(()=>{"use strict";Ft();yo=(e=null)=>{if(window&&window.sessionStorage){let n=e,o=0;if(!n){let r=window.sessionStorage.getItem(Ue.COUNT_OF_ACTIONS_IN_PROJECT);try{n=r?JSON.parse(r):null}catch{return 0}}try{for(let t in n)if(n.hasOwnProperty(t)){let r=n[t];o+=r}}catch{return o}return o}else return 0}});function R(e){if(window&&window.sessionStorage){let o=window.sessionStorage.getItem(Ue.COUNT_OF_ACTIONS_IN_PROJECT),t=null;try{t=o?JSON.parse(o):null}catch{return}let r="action";t&&t[r]?t[r]++:(t||(t={}),t[r]=1);let s=yo(t);s%100===0&&Jt.trigger("send-actions-made-data",s),window.sessionStorage.setItem(Ue.COUNT_OF_ACTIONS_IN_PROJECT,JSON.stringify(t))}}var rt=L(()=>{"use strict";mo();yr();De();go();Ft();ho()});var st,A,So,xo,_t=L(()=>{"use strict";st=H(Ye());fe();zn();Tt();lo();ao();Tr();pn();Te();Re();Ir();Ot();rt();De();A=({event:e,keyCode:n,ctrlOrCmd:o=!1,shift:t=!1,alt:r=!1})=>{let s=st.KeyBindingUtil.usesMacOSHeuristics();return n===e.keyCode&&t===e.shiftKey&&r===e.altKey&&(s?o===e.metaKey:o===e.ctrlKey)},So=e=>{let n=pe.isPermissionAllowed("TextCanChangeTypography"),o=pe.isPermissionAllowed("TextCanChangeAlign"),t=pe.isPermissionAllowed("TextCanChangeAdvancedTypography");if(A({event:e,keyCode:32,alt:!0}))return R("shortcut_alt_space"),"InsertNbsp";if(A({event:e,keyCode:32,alt:!0,ctrlOrCmd:!0}))return R("shortcut_ctrl_alt_space"),"InsertNbsp";if(A({event:e,keyCode:32,alt:!0,ctrlOrCmd:!0,shift:!0}))return R("shortcut_ctrl_alt_shift_space"),"InsertThinsp";if(A({event:e,keyCode:32,alt:!0,shift:!0}))return R("shortcut_alt_shift_space"),"InsertEnsp";if(A({event:e,keyCode:9}))return R(`shortcut_${e.key}`),"IncreaseIndent";if(A({event:e,keyCode:9,shift:!0}))return R(`shortcut_${e.key}_shift`),"DecreaseIndent";if(A({event:e,keyCode:65,ctrlOrCmd:!0,shift:!0}))return R("shortcut_a_ctrl_shift"),"SelectParagraph";if(A({event:e,keyCode:90,ctrlOrCmd:!0})&&R("shortcut_z_ctrl"),A({event:e,keyCode:90,ctrlOrCmd:!0,shift:!0})&&R("shortcut_z_ctrl_shift"),A({event:e,keyCode:65,ctrlOrCmd:!0})&&R("shortcut_a_ctrl"),A({event:e,keyCode:68,ctrlOrCmd:!0})&&R("shortcut_d_ctrl"),A({event:e,keyCode:68,ctrlOrCmd:!0,shift:!0})&&R("shortcut_d_ctrl_shift"),A({event:e,keyCode:84,alt:!0,ctrlOrCmd:!0}))return R("shortcut_t_ctrl_alt"),"ToggleTypographyPanel";if(A({event:e,keyCode:75,ctrlOrCmd:!0}))return R("shortcut_k_ctrl"),"ToggleLinkPanel";if(n){if(A({event:e,keyCode:38,alt:!0}))return R(`shortcut_${e.key}_alt`),"DecreaseLineHeight";if(A({event:e,keyCode:40,alt:!0}))return R(`shortcut_${e.key}_alt`),"IncreaseLineHeight";if(A({event:e,keyCode:37,alt:!0}))return R(`shortcut_${e.key}_alt`),"DecreaseLetterSpacing";if(A({event:e,keyCode:39,alt:!0}))return R(`shortcut_${e.key}_alt`),"IncreaseLetterSpacing";if(A({event:e,keyCode:190,ctrlOrCmd:!0,shift:!0}))return R("shortcut_>_ctrl_shift"),"IncreaseFontSize";if(A({event:e,keyCode:188,ctrlOrCmd:!0,shift:!0}))return R("shortcut_<_ctrl_shift"),"DecreaseFontSize"}if(o){if(A({event:e,keyCode:76,ctrlOrCmd:!0,shift:!0}))return R("shortcut_l_ctrl_shift"),"AlignLeft";if(A({event:e,keyCode:82,ctrlOrCmd:!0,shift:!0}))return R("shortcut_r_ctrl_shift"),"AlignRight";if(A({event:e,keyCode:67,ctrlOrCmd:!0,shift:!0}))return R("shortcut_c_ctrl_shift"),"AlignCenter"}if(t){if(A({event:e,keyCode:66,ctrlOrCmd:!0}))return R("shortcut_b_ctrl"),"ToggleBold";if(A({event:e,keyCode:73,ctrlOrCmd:!0}))return R("shortcut_i_ctrl"),"ToggleItalic";if(A({event:e,keyCode:85,ctrlOrCmd:!0}))return R("shortcut_u_ctrl"),"ToggleUnderline"}return(0,st.getDefaultKeyBinding)(e)},xo=({action:e,editorState:n,workspace:o})=>{if(e==="InsertNbsp")return{status:"handled",editorState:ke({editorState:n,text:wn})};if(e==="InsertEnsp")return{status:"handled",editorState:ke({editorState:n,text:"\u2002"})};if(e==="InsertThinsp")return{status:"handled",editorState:ke({editorState:n,text:"\u2009"})};if(e==="IncreaseIndent"){let t=wt({editorState:n,method:"increase"});if(t)return{status:"handled",editorState:t}}if(e==="backspace"||e==="DecreaseIndent"){let t=wt({editorState:n,method:"decrease"});if(t)return{status:"handled",editorState:t}}if(e==="DecreaseLineHeight"){let t=xt({editorState:n,method:"decrease"});if(t)return{status:"handled",editorState:t}}if(e==="IncreaseLineHeight"){let t=xt({editorState:n,method:"increase"});if(t)return{status:"handled",editorState:t}}if(e==="IncreaseLetterSpacing")if(n.getSelection().isCollapsed()){let t=kt(n,"next");if(t)return{status:"handled",editorState:t}}else{let t=It({editorState:n,method:"increase"});if(t)return{status:"handled",editorState:t}}if(e==="DecreaseLetterSpacing")if(n.getSelection().isCollapsed()){let t=kt(n,"prev");if(t)return{status:"handled",editorState:t}}else{let t=It({editorState:n,method:"decrease"});if(t)return{status:"handled",editorState:t}}if(e==="ToggleTypographyPanel"){let t=o.controls.findControl("text_typography");if(t)return t.onClick.apply(t),{status:"handled",editorState:n}}if(e==="ToggleLinkPanel"){let t=o.controls.findControl("text_link");if(t)return t.onClick.apply(t),{status:"handled",editorState:n}}if(e==="IncreaseFontSize")return{status:"handled",editorState:Rt({editorState:n,method:"increase"})};if(e==="DecreaseFontSize")return{status:"handled",editorState:Rt({editorState:n,method:"decrease"})};if(e==="AlignLeft"||e==="AlignRight"||e==="AlignCenter"){let t=e==="AlignLeft"?"align-left":e==="AlignRight"?"align-right":"align-center";return{status:"handled",editorState:fn({editorState:n,align:t})}}if(e==="SelectParagraph")return{status:"handled",editorState:Ln(n)};if(e==="ToggleBold"){let t=K(n,"FONT_WEIGHT");return{status:"handled",editorState:ye({editorState:n,key:"FONT_WEIGHT",value:t&&t[0]==="700"?V.fontWeight:"700"})}}if(e==="ToggleItalic"){let t=K(n,"FONT_STYLE");return{status:"handled",editorState:ye({editorState:n,key:"FONT_STYLE",value:t&&t[0]==="italic"?V.fontStyle:"italic"})}}if(e==="ToggleUnderline"){let t=K(n,"DECORATION");return{status:"handled",editorState:ye({editorState:n,key:"DECORATION",value:t&&t[0]==="underline"?"none":"underline"})}}}});var To,Co=L(()=>{"use strict";Rr();Re();Te();Jn();bt();fe();To=Wn({htmlToEntity:(e,n,o)=>{if(e==="a")return o(Xe,"MUTABLE",Vn(n))},htmlToStyle:(e,n,o)=>e==="b"?o.add(vt("FONT_WEIGHT","700")):e==="i"?o.add(vt("FONT_STYLE","italic")):o,htmlToBlock:(e,n)=>{if(e==="p"||e.match(/h\d/))return{type:"unstyled",data:Yn(n,{ignore:{lineHeight:!0,textStyles:!0}})}}})});var se,ko,Eo,At,bo,$r,zr,Vr,vo,wo,Yr,Po,Io,Ro=L(()=>{"use strict";se=H(Ye()),ko=H(Sr()),Eo=H(xr());fe();Jn();bt();_t();En();rt();De();Co();At="data-draftjs-conductor-fragment",bo='[data-contents="true"] [contenteditable="false"]',$r=e=>{let{anchorNode:n,focusNode:o}=e;if(!n||!o)return!1;let t=n instanceof Element?n:n.parentElement,r=o instanceof Element?o:o.parentElement,s=t&&t.closest(bo),i=r&&r.closest(bo);return s&&i&&(s.contains(i)||i.contains(s))},zr=(e,n)=>{let{selectionState:o}=(0,Eo.default)(e,n),t=(0,ko.default)(e.getCurrentContent(),o);return t.every(s=>!!(s&&s.getText().length===0))?null:t},Vr=(e,n,o)=>{let t=(o||window).getSelection();if(!n.clipboardData||!t||!e||t.rangeCount===0||$r(t)||!e.current?._latestEditorState)return;let r=zr(e.current?._latestEditorState,e.current?.editor);if(r){n.type==="copy"?R("shortcut_c_ctrl"):n.type==="cut"&&R("shortcut_x_ctrl");let s=se.ContentState.createFromBlockArray(r.toArray()),i=JSON.stringify((0,se.convertToRaw)(s)),l=document.createElement("div");l.appendChild(t.getRangeAt(0).cloneContents()),l.setAttribute(At,i),l.setAttribute("style","white-space: pre-wrap;"),n.clipboardData.setData("text/plain",t.toString()),n.clipboardData.setData("text/html",l.outerHTML),n.preventDefault()}},vo=(e,n)=>{let o=e.current?.editor,t=r=>{Vr(e,r,n)};return o&&o.addEventListener("copy",t),o&&o.addEventListener("cut",t),{unregister(){o&&o.removeEventListener("copy",t),o&&o.removeEventListener("cut",t)}}},wo=(e,n)=>{let o=e.current,t=o?.editor;if(!o||!t)return;let r=!1,s=l=>{r=A({event:l,keyCode:86,ctrlOrCmd:!0,shift:!0})},i=l=>{l.stopPropagation(),l.preventDefault(),l.cancelBubble=!0,l.returnValue=!1;let m=l.clipboardData?.getData("text/plain"),p=l.clipboardData?.getData("text/html");m&&o.props?.handlePaste&&(r?R("shortcut_v_ctrl_shift"):R("shortcut_v_ctrl"),o.props.handlePaste(m,p,o?._latestEditorState,n.forceCleanText?!0:r))};return n.forceCleanText||t.addEventListener("keydown",s,!0),t.addEventListener("paste",i,!0),{unregister(){n.forceCleanText||t.removeEventListener("keydown",s,!0),t.removeEventListener("paste",i,!0)}}},Yr=e=>{let o=new DOMParser().parseFromString(e,"text/html").querySelector(`[${At}]`);if(o){let t=o.getAttribute(At);try{if(t){let r=JSON.parse(t);if(r)return(0,se.convertFromRaw)(r)}}catch{return null}}return null},Po=(e="",n,o)=>{let t=n.getSelection(),r=!t.isCollapsed(),s=n.getCurrentContent(),i=_e(n),m=s.getBlockForKey(i[0]).getEntityAt(t.getStartOffset()),p="Text";return r&&!m&&Qe(e,o)&&(p="Link"),p},Io=({text:e,html:n,editorState:o,pastedWithShift:t})=>{let r=et(o),s=o.getCurrentContent(),i=_e(o),m=(()=>{let p=!t,a=i.some(u=>{let d=s.getBlockForKey(u);return!!ce({editorState:o,block:d})});if(p&&!a){let u=n?Yr(n):void 0,d=n?To(Gn(n)):void 0;if(u||d){let k=u?.getBlockMap()||d?.getBlockMap();if(k){let C=se.Modifier.replaceWithFragment(s,r,Kn(o,Nn({originStyles:o.getCurrentInlineStyle(),blockMap:k})));return se.EditorState.push(o,C,"insert-fragment")}}}return e?ke({editorState:o,text:e}):o})();if(i.length===1){let p=s.getBlockForKey(i[0]),a=p.getEntityAt(r.getStartOffset());if(a&&s.getEntity(a)?.getType()===Xe){let u=0,d=0;p.findEntityRanges(x=>x.getEntity()===a,(x,w)=>{u=x,d=w});let k=e?.length||0,C=r.getStartOffset(),c=r.getEndOffset(),f=Math.abs(c-C),y=r.merge({anchorOffset:u,focusOffset:d+k-f});m=Hn(m,y,a),m=se.EditorState.push(o,m.getCurrentContent(),"apply-entity");let S=C+k,g=r.merge({anchorOffset:S,focusOffset:S});m=be(m,g)}}return m}});var de,Mt,Gr,He,Jr,Oo,it=L(()=>{"use strict";de=H(ae()),Mt=H(Qt());Zt();qt();vr();Ee();Ve();ne();Gr=O.withComponent(xe("iframe")``),He=(0,de.createContext)({}),Jr=(0,de.forwardRef)(({children:e,contentDidMount:n,...o},t)=>{let[r,s]=(0,de.useState)(),[i,l]=(0,de.useState)(null),m=()=>{if(i){let d=i.contentDocument,k=i.contentWindow;if(d&&k){let C=d.querySelector("html");s({document:d,window:k,root:C}),n&&n()}}},{body:p,head:a}=(0,de.useMemo)(()=>r&&r.root?{body:r.root.querySelector("body"),head:r.root.querySelector("head")}:{},[r&&r.root]),u=(0,de.useMemo)(()=>$e({key:"frame-theme",container:r?.document.head}),[r&&r.document]);return h(Gr,{ref:xn(t,l),onLoad:m,frameBorder:"0",referrerPolicy:"origin",height:"100%",width:"100%",overflow:"hidden",border:"none",display:"block",srcDoc:"<!DOCTYPE html><html><head></head><body></body></html>",...o,children:r&&r.root?z(ge,{children:[o.head&&a&&(0,Mt.createPortal)(o.head,a),p&&(0,Mt.createPortal)(h(He.Provider,{value:r,children:h(ze,{value:u,children:h(O,{width:"100%",height:"100%",children:e})})}),p)]}):null})}),Oo=Jr});function Ni({permission:e,children:n}){let o=Ne(e);return h(Fo,{disabled:!o,children:n})}function Ne(e){return pe.isPermissionAllowed(e)}var Fo,Dt=L(()=>{"use strict";Ve();Ee();Ot();ne();Fo=xe(O)`
  &[disabled] {
    opacity: 0.4 !important;
    pointer-events: all !important;
    cursor: default !important;

    * {
      user-select: none !important;
      pointer-events: none !important;
      cursor: default !important;
    }

    input::selection {
      background: transparent !important;
    }
  }
`;Fo.displayName="PermissionContainer"});var Lo=L(()=>{"use strict";Dt()});var _o,Ao,qr,Xr,Zr,Mo=L(()=>{"use strict";_o=H(Ye()),Ao=(e,n)=>{let o=e.current,t=o?.editor;if(!o||!t)return;let r=()=>{let i=t;if(i){let l=new MouseEvent("mouseup",{view:n,bubbles:!0,cancelable:!0});i.dispatchEvent(l)}},s=i=>{i.stopPropagation(),i.preventDefault(),i.cancelBubble=!0,i.returnValue=!1,o._dragCount=0,o.exitCurrentMode();let l=Zr(i);if(l){if(o.props?.handleDrop){let m=o._internalDrag?"internal":"external";o.props?.handleDrop(l,{},m)}o._internalDrag=!1,r()}};return t.addEventListener("drop",s,!0),{unregister(){t.removeEventListener("drop",s,!0)}}},qr=e=>!e||!e.ownerDocument?document:e.ownerDocument,Xr=e=>{let n="data-offset-key",o=e.nodeType===Node.TEXT_NODE&&e.parentElement||e;if(!o)return null;let t=o.closest(`[${n}]`);if(!t)return null;let s=t.getAttribute(n)?.split("-");return s&&s.length?s[0]:null},Zr=e=>{let n=null,o=null,t=qr(e.currentTarget);if(typeof t.caretRangeFromPoint=="function"){let i=t.caretRangeFromPoint(e.x,e.y);n=i?.startContainer,o=i?.startOffset}else if(e.rangeParent)n=e.rangeParent,o=e.rangeOffset;else return null;let r=Xr(n);return r?new _o.SelectionState({anchorKey:r,anchorOffset:o,focusKey:r,focusOffset:o,isBackward:!1,hasFocus:!1}):null}});function Qr(e,n,o){return e<n?n:e>o?o:e}function Do(e,n){return n>=0&&e>=0&&e<n}function lt(e,n,o,t){return Number(Qr(e,n,o).toFixed(t))}function Bt(e,n,o){return e==="+"?n+o:n-o}function Uo(e,n,o,t,r=!1){let s=[e>o,Ut(e)>t];return r&&s.push(e<n),s.every(i=>!i)}function Ht(e){return e=Number(e),Number.isFinite(e)&&!Number.isNaN(e)}function Bo(e){return e===""||e.length===1&&e[0]==="-"?!0:!!e.endsWith(".")}function Ho(e){return e.replace(",",".")}function No(e){let n=e.trim();function o(t,r){return t===r}for(let t=0;t<n.length;t++){let r=n[t];if(r==="."||r===","||r===""||r==="-"){let s=n[t+1];(o(r,s)||r==="-"&&t>0)&&(n=n.slice(0,t)+n.slice(t+1),t--)}}return n}function Ko(e){return e===""||(e=e.trim(),e[0]==="."&&(e="0"+e)),e}var Ut,jo=L(()=>{"use strict";Ut=e=>e%1?e.toString().split(".")[1].length:0});function Wo({ref:e,value:n,disabled:o=!1}){let[t,r]=(0,at.useState)("");return(0,at.useEffect)(()=>{e.current&&!o&&r(es(e.current,n))},[n,o]),[o?"":t]}var at,es,$o=L(()=>{"use strict";at=H(ae());Cn();es=(e,n)=>{if(typeof document<"u"&&e){let o=typeof n=="number"?n.toString():n,t=document.createElement("span");document.body.appendChild(t);let r=getComputedStyle(e).getPropertyValue("font-size");r&&(t.style.fontSize=r.toString()),t.style.font=Ze.fonts.main,t.style.position="absolute",t.style.left="-9999px",t.style.margin="0",t.style.width="auto",t.style.whiteSpace="pre",t.innerHTML=o;let s=Math.ceil(t.clientWidth);return s=Math.ceil(s/2)*2+2,t.remove(),s+"px"}return""}});function ts(e,n){return{...e,...n}}function zo(e,n,o){let t=n.map(r=>{let s=ts(o,r.options);return e.addEventListener(r.eventName,r.fn,s),function(){e.removeEventListener(r.eventName,r.fn,s)}});return function(){t.forEach(r=>{r()})}}var Vo=L(()=>{"use strict"});var we,ns,ct,Yo=L(()=>{"use strict";we=H(ae()),ns=e=>{let n=(0,we.useRef)(e);return(0,we.useLayoutEffect)(()=>{n.current=e}),(0,we.useCallback)((...o)=>{let t=n.current;return t?.(...o)},[])},ct=ns});function os(e,n){return Math.abs(n.x-e.x)>=Go||Math.abs(n.y-e.y)>=Go}function rs({getPhase:e,setPhase:n,getActions:o,completed:t,disableClickThreshold:r}){return[{eventName:"mousemove",fn:s=>{let{clientX:i,clientY:l}=s,m={x:i,y:l},p=e(),a=o();if(p.type==="MOVING"){s.preventDefault(),a?.move(m,s);return}let u=p.point;!r&&!os(u,m)||(s.preventDefault(),n({type:"MOVING",point:m}),a?.start(s))}},{eventName:"mouseup",fn:s=>{let i=e(),l=o();if(i.type!=="MOVING"){t();return}s.preventDefault(),t(),l?.end(s)}}]}function Jo({disabled:e=!1,onMove:n,onMoveStart:o,onMoveEnd:t,disableClickThreshold:r=!1}={}){let[s,i]=(0,j.useState)({type:"IDLE",point:{x:0,y:0}}),l=j.default.useRef(s),m=j.default.useRef(),p=(0,j.useRef)(),a=ct(n),u=ct(o),d=ct(t);(0,j.useEffect)(()=>{l.current=s},[s]);let k=(0,j.useMemo)(()=>({move:(f,y)=>{a({event:y,offset:{x:f.x-l.current.point.x,y:f.y-l.current.point.y}})},start:f=>u(f),end:f=>d(f)}),[]);(0,j.useEffect)(()=>{m.current=k},[k]);let C=(0,j.useCallback)(()=>{l.current.type!=="IDLE"&&(i({type:"IDLE",point:{x:0,y:0}}),p.current?.())},[]),c=(0,j.useCallback)(f=>{if(e){typeof p.current=="function"&&p.current();return}if(f.ctrlKey||f.metaKey||f.shiftKey||f.altKey)return;let y={x:f.clientX,y:f.clientY};i({type:"PENDING",point:y});let S=rs({completed:C,getPhase:()=>l.current,setPhase:i,getActions:()=>m.current,disableClickThreshold:r});p.current=zo(window,S,{capture:!0,passive:!1})},[C,e]);return(0,j.useLayoutEffect)(()=>function(){p.current?.()},[]),(0,j.useMemo)(()=>({moving:s.type==="MOVING",start:c}),[c,s])}var j,Go,qo=L(()=>{"use strict";j=H(ae());Vo();Yo();Go=5});function Ke(e,n){return o=>{n&&n(o),e&&e(o)}}function Qo({direction:e,labelRef:n,...o}={}){let t=Jo(o);return(0,Y.useEffect)(()=>{if(!o.disabled)return n?.current&&e&&(n.current.style.setProperty("cursor",Zo[e]),n.current.style.setProperty("user-select","none"),n.current.addEventListener("mousedown",t.start)),()=>{n?.current&&(n.current.style.removeProperty("cursor"),n.current.style.removeProperty("user-select"),n.current.removeEventListener("mousedown",t.start))}},[t.start,o.disabled,e]),{...t,style:{cursor:o.disabled||!e?"initial":Zo[e]}}}var Y,Xo,ss,is,Nt,Zo,er=L(()=>{"use strict";Y=H(ae());Ve();Cn();wr();Fr();_r();Ar();jo();$o();qo();ne();Xo="Mixed";ss=xe(to,{excludeProps:["contextDetails"]})`
  margin: 0;
  padding: 0;
  appearance: textfield;
  border-bottom: none !important;
  font-family: ${Ze.fonts.main};

  &::-webkit-outer-spin-button,
  &::-webkit-inner-spin-button {
    appearance: none;
  }
`,is="NumericInput",Nt=(0,Y.forwardRef)((e,n)=>{let{value:o,isMixedValue:t=!1,step:r=1,shiftStep:s=10,direction:i="y",moveSpeed:l=3,autoWidth:m=!1,textStyle:p="subheading",min:a=Number.NEGATIVE_INFINITY,max:u=Number.POSITIVE_INFINITY,disableArrowInput:d=!1,text:k,disabled:C,disableScrubbing:c=!1,labelRef:f,floating:y,onChange:S,onScrubbing:g,onScrubbingStart:x,onScrubbingEnd:w,..._}=e,[E,T]=(0,Y.useState)(String(o)),[I,P]=(0,Y.useState)(!1),U=(0,Y.useRef)(0),B=(0,Y.useRef)(null),W=Tn(n,B),[X]=Wo({ref:B,value:t?Xo:E,disabled:!m}),{moving:oe,start:ee,style:me}=Qo({disabled:c||t||C,direction:i,labelRef:f,onMove:$,onMoveStart:M,onMoveEnd:J});(0,Y.useEffect)(()=>{T(String(o))},[o]);let re=(0,Y.useMemo)(()=>typeof y=="boolean"?y?1:0:typeof y=="number"?y:r!==void 0?Ut(r):0,[r,y]);function ie(F,D=!1){let q=Number(F),te=Do(q,a)&&!D;return Uo(q,a,u,re,D||!te)||(q=lt(q,a,u,re)),{isValid:Ht(q)&&!te,result:q}}function Z(F,D,q){let{isValid:te,result:ue}=ie(F,q?.fullValidate);T(ue.toString()),S&&te&&ue!==o&&S({value:ue,oldValue:o},D)}function Se(F){if(C)return;let D=Ho(F.target.value),q=No(D),te=Ko(q),ue=Bo(q),$t=Ht(te);!ue&&$t?Z(te,F):(ue||$t)&&T(te)}function Ie(){P(!0)}function je(F){if(P(!1),!t){let D=lt(o,a,u,re);Z(D,F,{fullValidate:!0})}}function We(F){if(F.code==="ArrowUp"||F.code==="ArrowDown"||F.code==="Enter"){F.preventDefault();let D=F.shiftKey?s*r:r;F.code==="ArrowUp"?Z(Bt("+",o,D),F,{fullValidate:!0}):F.code==="ArrowDown"&&Z(Bt("-",o,D),F,{fullValidate:!0}),F.code==="Enter"&&B.current&&B.current.blur()}}function mt(F){let D=F.target;D.selectionStart===D.selectionEnd&&D.select()}function gt(F){F.target.setSelectionRange(0,0);let D=f?.current?.contains(B.current);!t&&!D&&ee(F.nativeEvent)}function M(){x&&x(o),U.current=0}function J(){if(f&&!t){let F=lt(o,a,u,re);F!==o&&Z(F,void 0,{fullValidate:!0})}w&&w(o),U.current=0}function $({offset:F}){let D=F[i];if(i==="y"&&(D=-D),D){let q=Math.round(D/l),te=(q-U.current)*r;if(!t){let ue=te+o;ue!==o&&Z(ue,void 0,{fullValidate:!0})}g&&te!==0&&g(te,{mixed:!!t}),U.current=q}}let le={value:E,disabled:C,height:"fit-content",color:"inherit",..._,type:"text",onChange:Se,onBlur:Ke(je,e.onBlur),onFocus:Ke(Ie,e.onFocus),onMouseUp:Ke(mt,e.onMouseUp),onMouseDown:Ke(gt,e.onMouseDown)};return d||(le.onKeyDown=Ke(We,e.onKeyDown)),k!==void 0&&!I&&(le.value=k),t||(le.style={...me,..._?.style}),t&&(le.value=Xo,I&&(le.value="")),X&&(le.width=X),z(Y.Fragment,{children:[h(ss,{caretColor:oe?"transparent":"auto",textStyle:p,...le,ref:W}),oe?h(oo,{children:h(ro,{role:"presentation",backgroundColor:"transparent",zIndex:99999,style:me,userSelect:"none"})}):null]})});Nt.displayName=is;Zo={x:"ew-resize",y:"ns-resize"}});var tr,nr=L(()=>{"use strict";er();tr=Nt});function cs({editable:e,children:n,left:o,top:t,right:r,bottom:s,onChange:i,changedPaddings:l={}}){let{isPaddingsEnabled:m,setIsPaddingsEnabled:p}=(0,b.useContext)(ut),a=(0,b.useRef)(null).current,u=(0,b.useCallback)(x=>{a=x,p(!0)},[]),d=(0,b.useCallback)(x=>{(!a||a===x)&&p(!1)},[a]),k=(0,b.useRef)(null),{height:C}=Ae(k),c=(0,b.useMemo)(()=>C<Pe,[C]),f=(0,b.useCallback)(x=>i({top:x}),[i]),y=(0,b.useCallback)(x=>i({left:x}),[i]),S=(0,b.useCallback)(x=>i({right:x}),[i]),g=(0,b.useCallback)(x=>i({bottom:x}),[i]);return z(O,{position:"relative",style:{paddingTop:t,paddingLeft:o,paddingRight:r,paddingBottom:s},children:[e&&h(ge,{children:z(O,{contentEditable:!1,display:"inline",opacity:e?1:0,visibility:e?"visible":"hidden",userSelect:"none",children:[h(dt,{isSmall:c,isChanged:l?.top,from:"top",value:t,marginLeft:o,marginRight:r,onChange:f,onStart:u,onStop:d}),h(dt,{isSmall:c,isChanged:l?.left,from:"left",value:o,marginTop:t,marginBottom:s,onChange:y,onStart:u,onStop:d}),h(dt,{isSmall:c,isChanged:l?.right,from:"right",value:r,marginTop:t,marginBottom:s,onChange:S,onStart:u,onStop:d}),h(dt,{isSmall:c,isChanged:l?.bottom,from:"bottom",value:s,marginLeft:o,marginRight:r,onChange:g,onStart:u,onStop:d})]})}),h(O,{ref:k,className:"editor-block-wrapper",userSelect:m?"none":void 0,children:n})]})}var b,or,ls,ut,Pe,Kt,as,dt,rr,jt=L(()=>{"use strict";b=H(ae()),or=H(Qt());Zt();qt();sr();Ee();it();no();nr();ne();ls=$e({key:"padding-frame-theme",container:typeof document<"u"?document.head:void 0}),ut=(0,b.createContext)({}),Pe=43,Kt=2,as=(0,b.memo)(({isActive:e,isSmall:n,from:o,value:t,position:r,onChange:s,disabled:i})=>{let l=window.RM.constructorRouter.zoom.getZoom(),m=o==="top"||o==="bottom",p=n&&!m,a=(0,b.useRef)(null),{width:u,height:d}=Ae(a),k=(0,b.useMemo)(()=>(m?u:d)*l,[m,u,d,l]),C=a&&a.current?a.current.getBoundingClientRect():{x:0,y:0},c=(0,b.useMemo)(()=>p?10:o==="top"?"22px 22px 0 0":o==="right"?"0 22px 22px 0":o==="left"?"22px 0 0 22px":"0 0 22px 22px",[p,o]),f=(0,b.useMemo)(()=>{let E=k-Pe,T=r*l-Pe/2;return Math.max(0,T<=E?T:E)},[r,k,l]),{height:y,width:S}=(0,b.useMemo)(()=>({height:p?20:Pe,width:p?38:m?Pe:47}),[p,Pe,m]),{ref:g}=(0,b.useContext)(Wt),x=g&&g.current?g.current.getBoundingClientRect():{x:0,y:0},w=(0,b.useMemo)(()=>document.getElementById("paddings-input-portal"),[]),_=h(O,{display:"flex",position:"relative",justifyContent:p?"flex-start":"flex-end",flexDirection:m?"row":"column",style:{position:"absolute",...m?{left:f+x.x+C.x*l,top:x.y+C.y*l-(o==="top"?y:0)}:{top:f+x.y+C.y*l,left:x.x+C.x*l-(o==="left"?S:0)}},children:h(O,{display:"flex",backgroundColor:"blue",width:S,height:y,borderRadius:c,alignItems:"center",justifyContent:"center",zoom:"var(--workspace-inverse-zoom)",transform:"scale(var(--workspace-zoom))",transformOrigin:"left top",children:h(tr,{min:0,value:t,color:"white",fontSize:14,fontWeight:600,placeholder:"0",textAlign:"center",disabled:i,onChange:({value:E})=>s(E)})})});return h(ze,{value:ls,children:z(ge,{children:[h(O,{ref:a,width:"100%",height:"100%"}),e&&w?or.default.createPortal(_,w):null]})})}),dt=(0,b.memo)(({from:e,isChanged:n,onChange:o,value:t=0,isSmall:r,marginBottom:s=0,marginLeft:i=0,marginRight:l=0,marginTop:m=0,onStart:p,onStop:a})=>{let u=(0,b.useContext)(He),d=u&&u.window,k=(M,J)=>{let $=J;d&&d.addEventListener(M,$),window.addEventListener(M,$)},C=(M,J)=>{let $=J;d&&d.removeEventListener&&d.removeEventListener(M,$),window.removeEventListener(M,$)},c=e==="top"||e==="bottom",f=e==="bottom",[y,S]=(0,b.useState)(!1),[g,x]=(0,b.useState)(!1),[w,_]=(0,b.useState)(!1),[E,T]=(0,b.useState)(0),I=(0,b.useRef)(null),[P,U]=(0,b.useState)(0),[B,W]=(0,b.useState)(0),X=(0,b.useRef)(!1).current,oe=M=>{X=!0;let J=c?M.screenY:M.screenX,$=e==="right"?E-J:J-E;o(Math.max(0,t+$)),W(Math.max(0,(c?M.clientX:M.clientY)-P))},ee=()=>{x(!1),X&&(_(!1),a&&a(e)),X=!1};(0,b.useEffect)(()=>(g?(k("mousemove",oe),k("mouseup",ee)):(C("mousemove",oe),C("mouseup",ee)),()=>{C("mousemove",oe),C("mouseup",ee)}),[g]);let me=M=>{let J=document.getElementById("paddings-input-portal"),$=M.target;J&&!J.contains($)&&I.current&&!I.current.contains($)&&(_(!1),x(!1),ee(),a&&a(e))},re=M=>{M.key==="Escape"&&(_(!1),x(!1),ee(),a&&a(e))};(0,b.useEffect)(()=>(g||(w?(k("click",me),k("keyup",re)):(C("click",me),C("keyup",re),a&&a(e))),()=>{C("click",me),C("keyup",re)}),[g,w]);let ie=(0,b.useMemo)(()=>f?y||g?1:0:y||g?2:1,[g,y]),Z=(0,b.useMemo)(()=>c?`calc(100% - ${i+l}px)`:`${ie}px`,[ie,i,l]),Se=(0,b.useMemo)(()=>c?`${ie}px`:`calc(100% - ${s+m}px)`,[ie,s,m]),Ie=(0,b.useMemo)(()=>c?0+i:void 0,[i]),je=(0,b.useMemo)(()=>c?void 0:0+m,[m]),We=n?"tomato":"blue",mt=(0,b.useMemo)(()=>({width:c?"100%":t,height:c?t:`calc(100% - ${m+s}px)`,marginTop:c?0:m}),[c,t,m,s]),gt=(0,b.useMemo)(()=>({width:f?"100%":c?Z:`${Kt}px`,height:f||c?Kt:Se,left:f?0:Ie,top:je}),[f,c,Z,Se,Ie,je]);return z(O,{ref:I,position:"absolute",width:c?"100%":void 0,height:c?void 0:"100%",left:c?0:void 0,top:c?void 0:0,[e]:0,children:[h(O,{backgroundColor:"rgba(28, 222, 180, 0.18)",style:mt}),z(O,{position:"absolute",onMouseEnter:()=>S(!0),onMouseLeave:()=>S(!1),onMouseDown:M=>{let J=document.getElementById("paddings-input-portal");if(!(J&&J.contains(M.target))){if(!w){let $=M.target.getBoundingClientRect(),le=c?$.x:$.y;U(le),W(Math.max(0,(c?M.clientX:M.clientY)-le)),_(!0)}T(c?M.screenY:M.screenX),x(!0),p&&p(e)}},[e]:f?0:"100%",cursor:c?"row-resize":"col-resize",style:gt,children:[h(O,{position:"absolute",width:c?"100%":void 0,height:c?void 0:"100%",bottom:e==="top"?"100%":void 0,top:e==="bottom"?"100%":void 0,left:e==="right"?"100%":void 0,right:e==="left"?"100%":void 0,children:h(as,{isSmall:r,position:B,isActive:w,onChange:o,value:t,from:e,disabled:g})}),h(O,{display:"flex",width:"100%",height:"100%",alignItems:e==="top"?"flex-start":"flex-end",justifyContent:e==="right"?"flex-end":void 0,children:h(O,{style:{width:c?"100%":`${ie}px`,height:c?`${ie}px`:"100%",backgroundColor:y||g||f||t&&t>0?We:"transparent"}})})]}),f&&h(O,{position:"absolute",backgroundColor:t&&t>1?We:"transparent",top:0,height:"1px",style:{left:Ie,width:Z}})]})});rr=cs});function ds({children:e,...n}){let{model:{isEditMode:o,useTextWidgetStore:t}}=(0,Q.useContext)(Fe),{model:r}=(0,Q.useContext)(Le),s=r.flags?.calculatedLineHeight,i=Ne("TextCanChangePaddings"),[l,m]=t({partial:!1}),[p]=Ge(),{blockKey:a,block:u}=(0,Q.useMemo)(()=>{if(!n["data-offset-key"])return{};let T=n["data-offset-key"].split("-")[0],I=l.getCurrentContent().getBlockForKey(T);return{blockKey:T,block:I}},[n,l]),d=(0,Q.useMemo)(()=>ce({block:u}),[u]),k=(0,Q.useMemo)(()=>!!(a&&On(l,a)),[l,a]),C=k?"var(--editor-border-color)":"transparent",c=(0,Q.useMemo)(()=>[...p.global,...p.project].find(T=>T.name===d),[d,p,l]),{paddings:f,changedPaddings:y}=(0,Q.useMemo)(()=>{let T=Ct({block:u}),I=c?jn(c):{};return{paddings:{left:0,right:0,top:0,bottom:0,...I,...T},changedPaddings:gn({blockPaddings:T,stylePaddings:I})}},[l,u,c,p]),S=T=>{let I=_e(l),P=l.getCurrentContent(),U=I.reduce((B,W)=>{let X=P.getBlockForKey(W);if(X){let oe=Ct({block:X});return mn({editorState:B,block:X,paddings:{...oe,...T}})}return B},l);m(U)},g=(0,Q.useMemo)(()=>qe({block:u}),[l,u,p]),x=(0,Q.useMemo)(()=>$n({block:u}),[l,u]),w=(0,Q.useMemo)(()=>s?Dn({block:u,width:r.w}):{},[l,u,p]),_=(0,Q.useMemo)(()=>{if(u&&!ve({block:u})){let{r:I,g:P,b:U,a:B}=tn(Un(u));return`rgba(${I}, ${P}, ${U}, ${B})`}},[l,u]),E=i===!1?i:o&&k;return h(O,{...n,position:"relative",style:{lineHeight:typeof g=="number"?`${g}px`:void 0,textIndent:typeof x=="number"?`${x}px`:void 0,...w},css:Xt`
        // Заглушаем паддинги текстового стиля, чтобы отдать управление ими в TextPaddings
        padding: 0 !important;

        // Хак рамки, чтобы у нескольких элементов подряд не вышло 2px рамки
        &:after {
          content: '';
          pointer-events: none;
          box-shadow: 1px 0 0 0 ${C}, 0 1px 0 0 ${C}, 1px 1px 0 0 ${C},
            1px 0 0 0 ${C} inset, 0 1px 0 0 ${C} inset;
          position: absolute;
          top: 0;
          left: -1px;
          width: calc(100% + 1px);
          height: calc(100% - 1px);
        }

        // Дефолтный цвет для списков
        .editor-block-wrapper:before,
        div[data-offset-key]:before,
        & > li:before {
          ${_?`color: ${_};`:""}
        }
      `,children:h(rr,{editable:E,top:f.top,left:f.left,bottom:f.bottom,right:f.right,changedPaddings:y,onChange:S,children:e},a)})}var Q,ir,lr=L(()=>{"use strict";Q=H(ae());Je();fe();Ee();jt();Sn();br();Tt();zn();bn();Cr();nt();Dt();Ve();ne();ir=ds});var G,ft,ar,us,fs,cr,dr=L(()=>{"use strict";G=H(ae()),ft=H(Ye());Ee();ar=H(hr());Te();Zn();fe();Ro();it();Lo();Mo();En();Pr();bt();Je();rt();De();St();lr();Re();nt();dn();ne();us=()=>{let e=window.RM.constructorRouter&&!window.RM.constructorRouter.preview,n={...ln(),...en,...cn};return ar.default.Map(Object.keys(n).reduce((o,t)=>{let r=n[t].element,s=e?ir:r,i=tt(t)?h(Qn,{type:t}):void 0;return Object.assign(o,{[t]:{...n[t],element:s,wrapper:i}}),o},{}))},fs=(0,G.forwardRef)(({isEditMode:e,textDirection:n,autosize:o,columns:t,verticalAlign:r,bgColor:s,selectionColor:i,shouldShowSelectionBorder:l,useBaseline:m,disableSelectionHighlight:p,...a},u)=>{let d=(0,G.useRef)(null),k=(0,G.useContext)(He),C=Ne("TextCanChangeTypography");(0,G.useEffect)(()=>{if(d&&d.current!==null){let g=k&&k.window||window,x=d,w=vo(x,g),_=Ao(x,g),E=wo(x,{forceCleanText:!C});return()=>{w.unregister(),_?.unregister(),E?.unregister()}}},[d]),(0,G.useEffect)(()=>{let g=u;g!==null&&g.current&&d.current&&!g.current.focusEditor&&(g.current.focusEditor=d.current.focus)},[d,u]);let c=(0,G.useCallback)((g,x,w,_)=>{let{mag:E,workspace:T}=window.RM.constructorRouter,I=Po(g,w,E),P;switch(I){case"Link":{let U=Qe(g,E);if(U){let B=rn(),W=kn(E,B.project,B.global)||yn.name;P=vn({editorState:w,url:g,type:U,linkStyle:W}),T.controls?.select(T.controls?.findControl("text_link"))}break}case"Text":{P=Io({text:g,html:x,editorState:w,pastedWithShift:_});break}}return P?(a.onChange(P),"handled"):"not-handled"},[a.onChange]),f=(0,G.useCallback)((g,x)=>{if(g.shiftKey){R("shortcut_shift_enter");let _=An(x);return a.onChange(_),"handled"}let w=_n(x);if(w){let{status:_,editorState:E}=w;return a.onChange(E),_}return"not-handled"},[a.onChange]),y=(0,G.useCallback)(g=>g?(a.onChange(Mn({editorState:a.editorState,dropSelection:g})),"handled"):"not-handled",[a.onChange,a.editorState]),S=(0,G.useMemo)(()=>ft.DefaultDraftBlockRenderMap.merge(us()),[]);return h(Xn,{ref:u,textDirection:n,autosize:o,columns:t,verticalAlign:r,bgColor:s,selectionColor:i,shouldShowSelectionBorder:l,useBaseline:m,isEditMode:e,disableSelectionHighlight:p,children:h(O,{children:h(ft.Editor,{ref:d,spellCheck:!1,autoCapitalize:"off",autoComplete:"off",autoCorrect:"off",stripPastedStyles:!1,blockRenderMap:S,customStyleFn:nn,handlePaste:c,handleReturn:f,handleDrop:y,...a})})})}),cr=fs});var N,ur,Ca,fr=L(()=>{"use strict";N=H(ae());Te();Je();fe();Re();nt();St();Tt();Er();Gt();ur=(e,n={})=>{let[o,t]=ht(),[r]=Ge(),s=Array.isArray(e)?e:[e],i=(0,N.useMemo)(()=>s.map(c=>Pn(c)),[s]),l=(0,N.useMemo)(()=>[...r.global,...r.project],[r.global,r.project]),m=(0,N.useMemo)(()=>s.map(c=>ce({editorState:c})),[s]),p=(0,N.useMemo)(()=>m.map(c=>l.find(f=>f.name===c)).filter(Boolean),[m,l]),a=(0,N.useMemo)(()=>s.map((c,f)=>{let y=K(c,"FONT_FAMILY"),S=p[f];return y.length?y[0]:S?S.cssProperties.fontFamily||"":V.fontFamily}),[p,s]),u=(0,N.useMemo)(()=>s.map((c,f)=>{let y=K(c,"FONT_STYLE"),S=p[f];return y.length?y[0]:S?S.cssProperties.fontStyle||"":V.fontStyle}),[p,s]),d=(0,N.useMemo)(()=>s.map((c,f)=>{let y=K(c,"FONT_WEIGHT"),S=p[f];return y.length?y[0]:S?S.cssProperties.fontWeight||"":V.fontWeight}),[p,s]);(0,N.useEffect)(()=>{if(n.listenFontFeaturesUpdates&&a.length&&d.length&&u.length){let c=s.map((f,y)=>{let S=Vt(a)[y],g=d[y],x=u[y];if(S){let w=Oe({fontFamily:S,fontWeight:g,fontStyle:x});if(!o[w])return Et({fontFamily:S,fontWeight:g,fontStyle:x}).then(E=>({res:E,key:w}))}});Promise.all(c).then(f=>{let y={};f.forEach(S=>{S?.res&&(y[S.key]=S.res)}),Object.keys(y).length!==0&&t({...o,...y})})}},[s]);let k=(0,N.useMemo)(()=>s.map((c,f)=>{let y=a[f],S=d[f],g=u[f];if(y&&S&&g){let x=Oe({fontFamily:y,fontWeight:S,fontStyle:g});return o[x]}}),[s,o]);return(0,N.useMemo)(()=>{let c={textStyle:[],textStyleName:[],fontFamily:[],fontStyle:[],fontWeight:[],fontInfo:[],fontSize:[],lineHeight:[],ratio:[],letterSpacing:[],fontSizeLinkStatus:[],letterSpacingLinkStatus:[]};for(let f=0;f<s.length;f++){let y=s[f],S=p[f],g=i[f],x=k[f],w=m[f],_=a[f],E=u[f],T=d[f],I=S&&S.name!=="unstyled",P=I&&Ce(S?.cssProperties.fontSize),U=I&&Ce(S?.cssProperties.lineHeight),B=I&&Ce(S?.cssProperties.letterSpacing,!0),W=K(y,"FONT_SIZE"),X=K(y,"LETTER_SPACING"),oe=qe({block:g}),ee=K(y,"IS_LINKED_LETTER_SPACING"),me=hn({block:g}),re=W?.length?parseInt(W[0]):P||V.fontSize,ie=X?.length?parseFloat(X[0]):B||0,Z=typeof oe=="number"?oe:U||V.lineHeight,Se=ee&&ee[0]&&typeof ee[0]<"u"?ee[0]==="true":!1;c.textStyle.push(S),c.textStyleName.push(w),c.fontFamily.push(_),c.fontStyle.push(E),c.fontWeight.push(T),c.fontInfo.push(x),c.fontSize.push(re),c.lineHeight.push(Z),c.ratio.push(re/Z),c.letterSpacing.push(ie),c.fontSizeLinkStatus.push(me),c.letterSpacingLinkStatus.push(Se)}return c},[s,i,p,a,k,u,d,m])},Ca=(e,n={})=>{let[o,t]=ht(),[r]=sn(),s=(0,N.useMemo)(()=>[...r.global,...r.project],[r.global,r.project]),i=(0,N.useMemo)(()=>ve({editorState:e}),[e]),l=(0,N.useMemo)(()=>s.find(d=>d.name===i),[s,i]),m=(0,N.useMemo)(()=>{let d=K(e,"FONT_FAMILY");return l?l.cssProperties.fontFamily||"":d.length?d[0]:V.fontFamily},[l,e,i]),p=(0,N.useMemo)(()=>{let d=K(e,"FONT_STYLE");return l?l.cssProperties.fontStyle||V.fontStyle:d.length?d[0]:V.fontStyle},[l,e,i]),a=(0,N.useMemo)(()=>{let d=K(e,"FONT_WEIGHT");return l?l.cssProperties.fontWeight||"":d.length?d[0]:V.fontWeight},[l,e,i]);(0,N.useEffect)(()=>{if(n.listenFontFeaturesUpdates&&m&&a&&p){let d=Oe({fontFamily:m,fontWeight:a,fontStyle:p});o[d]||Et({fontFamily:m,fontWeight:a,fontStyle:p}).then(C=>{if(C){let{features:c,variations:f,characters:y}=C;t({...o,[d]:{features:c,variations:f,characters:y}})}})}},[e,n.listenFontFeaturesUpdates]);let u=(0,N.useMemo)(()=>{if(m&&a&&p){let d=Oe({fontFamily:m,fontWeight:a,fontStyle:p});return o[d]}},[e,o]);return{listStyle:l,listStyleName:i,fontFamily:m,fontStyle:p,fontWeight:a,fontInfo:u}}});function ps({readOnly:e}){let{model:n,modelSet:o,modelSave:t}=(0,v.useContext)(Le),{model:{useTextWidgetStore:r,isEditMode:s,workspace:i,selected:l,isJustCreated:m,disableSelectionHighlight:p,isResizing:a}}=(0,v.useContext)(Fe),[u,d]=r({partial:!1});ur(u,{listenFontFeaturesUpdates:!0});let{isPaddingsEnabled:k}=(0,v.useContext)(ut),{callback:C}=Pt(t,400),{callback:c}=Pt(T=>{if(s&&T.getLastChangeType()){let P=In(T.getCurrentContent()),U=Object.keys(P),B=(0,pt.pick)(n,...U),W=(0,pt.isEqual)(P,B);o(P),W||C()}},20);(0,v.useEffect)(()=>{s&&m&&setTimeout(()=>{S.current?.focusEditor()},0)},[]),(0,v.useEffect)(()=>{c(u)},[u]);let f=(0,v.useMemo)(()=>u.getSelection().getHasFocus(),[u]),y=(0,v.useMemo)(()=>s,[s,f]),S=(0,v.useRef)(null),{height:g}=Ae(S),x=(0,v.useMemo)(()=>n.columns&&n.columns.count>1,[n.columns]);(0,v.useEffect)(()=>{!a&&g>0&&g!==n.h&&s&&!x&&n.autosize&&(o({h:g}),C())},[g,n.autosize,n.h,x,a]),(0,v.useEffect)(()=>{!Modernizr.firefox&&!s&&!u.getSelection().isCollapsed()&&d(Rn(u))},[s]);let w=(0,v.useCallback)(T=>{let I=T.getType(),P=ce({block:T}),U=un({block:T}),B=tt(I)?ve({block:T})||(n.flags?.newListPosition?an:void 0):void 0;return["edit-mode",I,P,U,B].filter(W=>W).join(" ")},[]),_=(0,v.useCallback)(T=>{let I=T.getSelection(),P=T;P=Bn(P,u),P=be(P,Fn(I)),P=P.getSelection().isCollapsed()?P:be(P,et(P)),Modernizr.safari&&!I.isCollapsed()&&(P=be(P,P.getSelection(),!1)),d(P)},[u]),E=(0,v.useCallback)(T=>{let I=xo({action:T,editorState:u,workspace:i});if(I){let{editorState:P,status:U}=I;return d(P),U}else return"not-handled"},[u,i]);return h(cr,{ref:S,isEditMode:s,bgColor:n.bgColor,selectionColor:n.selectionColor,textDirection:n.textDirection||"LTR",autosize:n.autosize,columns:n.columns,verticalAlign:n.verticalAlign,useBaseline:n.flags?.baseline,shouldShowSelectionBorder:y,editorState:u,disableSelectionHighlight:p,blockStyleFn:w,onChange:_,readOnly:!s||!l||e||k,keyBindingFn:So,handleKeyCommand:E})}function ms({size:e,height:n,width:o,onClick:t}){return z(ge,{children:[h(O,{position:"absolute",top:0,left:0,onClick:t,userSelect:"none",style:{width:o+e*2,height:e}}),h(O,{position:"absolute",bottom:0,left:0,onClick:t,userSelect:"none",style:{width:o+e*2,height:e}}),h(O,{position:"absolute",top:0,left:0,width:e,onClick:t,userSelect:"none",style:{width:e,height:n+e*2}}),h(O,{position:"absolute",top:0,right:0,onClick:t,userSelect:"none",style:{width:e,height:n+e*2}})]})}function ys(){let{model:{useTextWidgetStore:e,fontStyles:n,isResizing:o,leaveEditMode:t,isEditMode:r,canControlsBeClosed:s,onIframeLoaded:i}}=(0,v.useContext)(Fe),[l]=e({partial:!1}),{model:{w:m,h:p}}=(0,v.useContext)(Le),[a,u]=(0,v.useState)(!1);(0,v.useEffect)(()=>{a&&zt()},[a,o]);let d=(0,v.useRef)(null),k=(0,v.useMemo)(()=>{let E={position:"absolute",top:he*-1,left:he*-1,width:`calc(100% + ${he*2}px)`,height:`calc(100% + ${he*2}px)`,fontFamily:"-apple-system, system-ui, BlinkMacSystemFont, 'Segoe UI', Ubuntu, 'Fira Sans', Roboto, 'Avenir Next', 'Helvetica Neue', Helvetica, Arial, sans-serif",lineHeight:1};return{display:r?void 0:"none",pointerEvents:!r||a||o?"none":void 0,userSelect:"none",...E}},[he,r,a,o]),C=(0,v.useCallback)(()=>{s()&&t()},[s,t]),[c,f]=(0,v.useState)(!1),[y,S]=(0,v.useState)(!1);(0,v.useEffect)(()=>{r&&!c&&f(!0)},[r]);let[g,x]=(0,v.useState)(!1),w=(0,v.useRef)(null),_=()=>{let E=d.current?.contentDocument?.hasFocus()||!1;if(E){let T=d.current?.contentDocument?.getSelection();T&&T.anchorNode&&T.focusNode&&(w.current={anchorNode:T.anchorNode,anchorOffset:T.anchorOffset,focusNode:T.focusNode,focusOffset:T.focusOffset})}x(E)};return(0,v.useEffect)(()=>(d.current?.contentDocument?.addEventListener("selectionchange",_),()=>{d.current?.contentDocument?.removeEventListener("selectionchange",_)}),[d.current?.contentDocument]),(0,v.useEffect)(()=>{if(Modernizr.safari){let E=l.getSelection(),T=E.getHasFocus();if(!g&&T&&!E.isCollapsed()){let I=d.current?.contentWindow?.getSelection();I&&w.current&&I.setBaseAndExtent(w.current.anchorNode,w.current.anchorOffset,w.current.focusNode,w.current.focusOffset)}}},[l,g]),h(Wt.Provider,{value:{ref:d},children:h(ut.Provider,{value:{isPaddingsEnabled:a,setIsPaddingsEnabled:u},children:z(O,{position:"relative",width:"calc(var(--workspace-inverse-zoom) * 100%)",height:"calc(var(--workspace-inverse-zoom) * 100%)",zoom:"var(--workspace-inverse-zoom)",transform:"scale(var(--workspace-zoom))",transformOrigin:"left top",children:[c&&z(Oo,{ref:d,style:k,head:z(ge,{children:[h("style",{children:`
                      body {
                        margin: 0;
                        height: 100vh;
                        width: 100vw;
                        overflow: hidden;
                        box-sizing: border-box;
                        padding: ${he}px ${he-qn}px;
                      }

                      ol, ul {
                        padding: 0;
                        margin: 0;
                      }
                  `}),n.map((E,T)=>{if(E.tag==="style")return h("style",{children:`${E.style}`},T);if(E.tag==="link")return h("link",{rel:"stylesheet",type:E.type,href:E.href},T)})]}),contentDidMount:()=>{i(),S(!0)},children:[h(io,{mode:"constructor"}),r&&h(gs,{size:he,height:p,width:m,onClick:C}),h(ps,{})]}),r&&y?null:h(O,{height:"100%",width:"100%",position:"absolute",top:0,left:0,pointerEvents:"none",userSelect:"none",children:h(eo,{editorState:l,isConstructorPreview:!0})})]})})})}var v,pt,pr,Wt,gs,he,Ga,sr=L(()=>{v=H(ae()),pt=H(gr());Ur();bn();pr=H(Lr());dr();fe();kr();pn();jt();Sn();_t();Dr();nt();dn();Or();Ee();it();Zn();fr();no();mr();ne();Wt=(0,v.createContext)({});gs=(0,v.memo)(ms,pr.default),he=500;Ga=ys});export{Me as a,co as b,Is as c,Br as d,Rs as e,Hr as f,Os as g,Fs as h,Ls as i,_s as j,uo as k,As as l,fo as m,pe as n,Ot as o,To as p,Co as q,mo as r,De as s,Ue as t,Ft as u,R as v,rt as w,Fo as x,Ni as y,Ne as z,Lo as A,Wo as B,$o as C,ct as D,Yo as E,Jo as F,qo as G,tr as H,nr as I,ur as J,Ca as K,fr as L,Wt as M,he as N,Ga as O,sr as P};
