import{a as o}from"https://st-p.rmcdn1.net/bb5ea210/dist/c/c-E67PEJVR.js";import{a as g,b as _}from"https://st-p.rmcdn1.net/bb5ea210/dist/c/c-CDNKGYE5.js";import"https://st-p.rmcdn1.net/bb5ea210/dist/c/c-YFHFYU7S.js";import"https://st-p.rmcdn1.net/bb5ea210/dist/c/c-5LFVFH3C.js";import"https://st-p.rmcdn1.net/bb5ea210/dist/c/c-B27MLL7B.js";import"https://st-p.rmcdn1.net/bb5ea210/dist/c/c-L2B3GM7D.js";import"https://st-p.rmcdn1.net/bb5ea210/dist/c/c-GCY7V35C.js";import"https://st-p.rmcdn1.net/bb5ea210/dist/c/c-BOWCSWOB.js";import"https://st-p.rmcdn1.net/bb5ea210/dist/c/c-4BILSRI5.js";import"https://st-p.rmcdn1.net/bb5ea210/dist/c/c-FD6I35KR.js";import"https://st-p.rmcdn1.net/bb5ea210/dist/c/c-FSOH4R4Z.js";import"https://st-p.rmcdn1.net/bb5ea210/dist/c/c-RC6BJBCI.js";import"https://st-p.rmcdn1.net/bb5ea210/dist/c/c-LYKZSZUD.js";import"https://st-p.rmcdn1.net/bb5ea210/dist/c/c-UPGAECPZ.js";import"https://st-p.rmcdn1.net/bb5ea210/dist/c/c-2KAPHHOB.js";import"https://st-p.rmcdn1.net/bb5ea210/dist/c/c-YHWQFOQU.js";import"https://st-p.rmcdn1.net/bb5ea210/dist/c/c-3KHETOCD.js";import"https://st-p.rmcdn1.net/bb5ea210/dist/c/c-6M5ZVJHJ.js";import"https://st-p.rmcdn1.net/bb5ea210/dist/c/c-NQJYLIBR.js";import"https://st-p.rmcdn1.net/bb5ea210/dist/c/c-O4ZZWP2U.js";import"https://st-p.rmcdn1.net/bb5ea210/dist/c/c-7JL7C5NM.js";import"https://st-p.rmcdn1.net/bb5ea210/dist/c/c-BWH3Y3RJ.js";import"https://st-p.rmcdn1.net/bb5ea210/dist/c/c-WPU45C53.js";import"https://st-p.rmcdn1.net/bb5ea210/dist/c/c-ZEAVY7WC.js";import"https://st-p.rmcdn1.net/bb5ea210/dist/c/c-3XEEEBBV.js";import"https://st-p.rmcdn1.net/bb5ea210/dist/c/c-D5EM447W.js";import"https://st-p.rmcdn1.net/bb5ea210/dist/c/c-NRBJ4WPE.js";import"https://st-p.rmcdn1.net/bb5ea210/dist/c/c-FE3QMTGC.js";import"https://st-p.rmcdn1.net/bb5ea210/dist/c/c-IGQYKUPD.js";import"https://st-p.rmcdn1.net/bb5ea210/dist/c/c-ROMJVQG3.js";import"https://st-p.rmcdn1.net/bb5ea210/dist/c/c-N77WQBOT.js";import"https://st-p.rmcdn1.net/bb5ea210/dist/c/c-ZPFFJAVX.js";import"https://st-p.rmcdn1.net/bb5ea210/dist/c/c-ZJC5GDGC.js";import"https://st-p.rmcdn1.net/bb5ea210/dist/c/c-BGYGN5WZ.js";import"https://st-p.rmcdn1.net/bb5ea210/dist/c/c-P2GAP4WX.js";import"https://st-p.rmcdn1.net/bb5ea210/dist/c/c-UN3QA576.js";import"https://st-p.rmcdn1.net/bb5ea210/dist/c/c-QYGQR2I3.js";import"https://st-p.rmcdn1.net/bb5ea210/dist/c/c-7C7KWFVC.js";import"https://st-p.rmcdn1.net/bb5ea210/dist/c/c-GA4DPJVF.js";import"https://st-p.rmcdn1.net/bb5ea210/dist/c/c-HWHCYD2L.js";import"https://st-p.rmcdn1.net/bb5ea210/dist/c/c-XS2VTMON.js";import"https://st-p.rmcdn1.net/bb5ea210/dist/c/c-GXGN7WTM.js";import"https://st-p.rmcdn1.net/bb5ea210/dist/c/c-QDYTPFQ4.js";import"https://st-p.rmcdn1.net/bb5ea210/dist/c/c-RQJXUDDG.js";import"https://st-p.rmcdn1.net/bb5ea210/dist/c/c-D5H7EYNT.js";import"https://st-p.rmcdn1.net/bb5ea210/dist/c/c-WYUSCFYK.js";import"https://st-p.rmcdn1.net/bb5ea210/dist/c/c-UHM3TZXV.js";import"https://st-p.rmcdn1.net/bb5ea210/dist/c/c-5MV3K6RQ.js";import"https://st-p.rmcdn1.net/bb5ea210/dist/c/c-YF6D56FI.js";import"https://st-p.rmcdn1.net/bb5ea210/dist/c/c-QMAGPDJU.js";import{a as y}from"https://st-p.rmcdn1.net/bb5ea210/dist/c/c-ZFCUQYEE.js";import{c as u}from"https://st-p.rmcdn1.net/bb5ea210/dist/c/c-S7MQREXB.js";import"https://st-p.rmcdn1.net/bb5ea210/dist/c/c-VOJA64E4.js";import{d as m}from"https://st-p.rmcdn1.net/bb5ea210/dist/c/c-MXCJJCFW.js";var r=m(y()),a=m(u());_();var w=o.extend({MIN_TOP_SCROLL_SPACE:5,TIME_OF_STOPPED_SCROLL:55,render:function(){return this.makeBox("widget-slideshow"),this.pictures=a.default.filter(this.pictures,function(t){return!t.error}),this.player=new g({params:this,$container:this.$el,environment:"viewer",block:null,mag:this.page&&this.page.mag,page:this.page,viewport:this.page.pageViewport}),this.play_method!==void 0&&this.play_method==="scroll"&&((0,r.default)(window).on("scroll",this.onScrollTransition),this.innerContentTop=this.page.contentPosition.top/this.page.scale,this.innerContainerHeight=this.page.mag.getContainerSizeCached().height/this.page.scale,this.isScrolling=!1,this.$image=this.$el.find(".image"),this.lastScrollTop=0,this.isCrossfade=this.transition_type==="crossfade",this.delay=(this.theme_data.scroll_delay>0?this.theme_data.scroll_delay:1)+(this.isCrossfade?this.theme_data.crossfade:0),this.picsID=[],this.player.$images_wrapper.children(".image").each((e,i)=>{this.picsID.push((0,r.default)(i).attr("data-id"))})),this.player.on("ready",a.default.bind(function(){setTimeout(this.widgetIsLoaded,100)},this)),this.theme_data.arrows&&(this.theme_data.arrows_type==="library"||this.theme_data.arrows_type==="noun")&&this.renderNounIcons(),this.rendered=!0,this},onScrollTransition:function(){let t=window.pageYOffset||document.documentElement.scrollTop,e=this.y+this.innerContentTop,i=e-this.innerContainerHeight,s=0,n=s*(e-i)+i+this.theme_data.start_offset||0,d=this.isCrossfade?this.theme_data.crossfade*10:this.TIME_OF_STOPPED_SCROLL,l=this.picsID.length,f=n>0?(t-n*this.page.scale)/this.page.scale:t/this.page.scale,c=Math.floor(f/this.delay),h=c+1,p=h>=l?h-Math.floor(h/l)*l:h;this.isScrolling&&(this.setFreezeStyles(t),p>=0&&this.player.currentImageID!==this.picsID[p]&&this.changeImage(t,c,this.picsID[p])),n<=0&&t<this.MIN_TOP_SCROLL_SPACE?setTimeout(()=>{this.changeImage(t,c,this.picsID[0]),this.isScrolling=!1},d):(clearTimeout(this.isScrolling),this.isScrolling=setTimeout(()=>{this.setFreezeStyles(t)},d))},changeImage:function(t,e,i){(t>this.lastScrollTop&&t>=e*this.delay||t<this.lastScrollTop&&t>=(e-1)*this.delay)&&this.player.moveToImage(i,!0,"switch-to-image-scroll"),this.lastScrollTop=t<=0?0:t},setFreezeStyles:function(){let t=this.$el.find(".center-image"),e=this.$el.find(".prev-image"),i=this.getRealOpacity(t.css("opacity")),s=this.getRealOpacity(e.css("opacity"));this.isCrossfade&&(t.css({opacity:i>s?i:1-s}),e.css({opacity:s>i?s:1-i}),!t.hasClass("changed-opacity")&&!e.hasClass("changed-opacity")&&e.addClass("changed-opacity"))},getRealOpacity:function(t){return t<.1?t*10:t},renderNounIcons:function(){let t=this.theme_data.arrows_position,e=this.left_arrow_noun&&this.left_arrow_noun.rasterUrl?this.left_arrow_noun:this.theme_data.left_icon_noun,i=this.right_arrow_noun&&this.right_arrow_noun.rasterUrl?this.right_arrow_noun:this.theme_data.right_icon_noun;if(e&&(e.rasterUrl||e.b64url)){let s=(0,r.default)("<img>");s.on("load",a.default.bind(function(){t==="bottom"?this.$el.find(".prev-picture-arrow-bottom").empty().html(s.clone()):this.$el.find(".prev-picture-arrow-middle").empty().html(s.clone())},this)).on("error",this.widgetIsLoaded),s.attr("src",e.raster3xUrl||e.raster2xUrl||e.rasterUrl||e.b64url||"")}if(i&&(i.rasterUrl||i.b64url)){let s=(0,r.default)("<img>");s.on("load",a.default.bind(function(){t==="bottom"?this.$el.find(".next-picture-arrow-bottom").empty().html(s.clone()):this.$el.find(".next-picture-arrow-middle").empty().html(s.clone())},this)).on("error",this.widgetIsLoaded),s.attr("src",i.raster3xUrl||i.raster2xUrl||i.rasterUrl||i.b64url||"")}},isValid:function(){return this.pictures&&this.pictures.length},start:function(){return o.prototype.start.call(this),!RM.screenshot&&!this.destroyed&&this.player&&(this.theme_data.autoplay&&this.play_method===void 0||this.play_method==="autoplay")&&this.rendered&&this.loaded&&this.player.startAutoplay(),this},stop:function(){return o.prototype.stop.call(this),!RM.screenshot&&!this.destroyed&&this.player&&this.rendered&&this.loaded&&this.player.stopAutoplay(),this},destroy:function(){return this.player&&this.player.off(),this.player&&this.player.destroy(),this.player=null,this.play_method==="scroll"&&(0,r.default)(window).off("scroll",this.onScrollTransition),o.prototype.destroy.apply(this,arguments)}}),T=w;export{T as default};
