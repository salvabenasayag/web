import{a as j,b as mt}from"https://st-p.rmcdn1.net/bb5ea210/dist/c/c-L2B3GM7D.js";import{n as R,o as ht}from"https://st-p.rmcdn1.net/bb5ea210/dist/c/c-LYKZSZUD.js";import{Db as W,N as q,Q as yt,oc as gt}from"https://st-p.rmcdn1.net/bb5ea210/dist/c/c-UPGAECPZ.js";import{n as I,o as ut}from"https://st-p.rmcdn1.net/bb5ea210/dist/c/c-IGQYKUPD.js";import{a as Y,h as dt}from"https://st-p.rmcdn1.net/bb5ea210/dist/c/c-BGYGN5WZ.js";import{C as rt,h as K}from"https://st-p.rmcdn1.net/bb5ea210/dist/c/c-UHM3TZXV.js";import{b as D,c as ct}from"https://st-p.rmcdn1.net/bb5ea210/dist/c/c-5MV3K6RQ.js";import{j as X,k as M,l as pt}from"https://st-p.rmcdn1.net/bb5ea210/dist/c/c-YF6D56FI.js";import{b as ft,c as J,e as lt}from"https://st-p.rmcdn1.net/bb5ea210/dist/c/c-QMAGPDJU.js";import{a as at}from"https://st-p.rmcdn1.net/bb5ea210/dist/c/c-ZFCUQYEE.js";import{c as st}from"https://st-p.rmcdn1.net/bb5ea210/dist/c/c-S7MQREXB.js";import{a as H,b as it,d as U}from"https://st-p.rmcdn1.net/bb5ea210/dist/c/c-MXCJJCFW.js";var Q=it((z,G)=>{"use strict";(function(o,n){if(typeof define=="function"&&define.amd)define(["exports","module"],n);else if(typeof z<"u"&&typeof G<"u")n(z,G);else{var i={exports:{}};n(i.exports,i),o.fetchJsonp=i.exports}})(z,function(o,n){"use strict";var i={timeout:5e3,jsonpCallback:"callback",jsonpCallbackFunction:null};function s(){return"jsonp_"+Date.now()+"_"+Math.ceil(Math.random()*1e5)}function r(a){try{delete window[a]}catch{window[a]=void 0}}function p(a){var t=document.getElementById(a);t&&document.getElementsByTagName("head")[0].removeChild(t)}function f(a){var t=arguments.length<=1||arguments[1]===void 0?{}:arguments[1],l=a,e=t.timeout||i.timeout,d=t.jsonpCallback||i.jsonpCallback,c=void 0;return new Promise(function(m,x){var g=t.jsonpCallbackFunction||s(),k=d+"_"+g;window[g]=function(u){m({ok:!0,json:function(){return Promise.resolve(u)}}),c&&clearTimeout(c),p(k),r(g)},l+=l.indexOf("?")===-1?"?":"&";var h=document.createElement("script");h.setAttribute("src",""+l+d+"="+g),t.charset&&h.setAttribute("charset",t.charset),t.nonce&&h.setAttribute("nonce",t.nonce),t.referrerPolicy&&h.setAttribute("referrerPolicy",t.referrerPolicy),t.crossorigin&&h.setAttribute("crossorigin","true"),h.id=k,document.getElementsByTagName("head")[0].appendChild(h),c=setTimeout(function(){x(new Error("JSONP request to "+a+" timed out")),r(g),p(k),window[g]=function(){r(g)}},e),h.onerror=function(){x(new Error("JSONP request to "+a+" failed")),r(g),p(k),c&&clearTimeout(c)}})}n.exports=f})});var Z,tt=H(()=>{"use strict";mt();Z={"template-export-pdf-typekit-substitution-news-gothic":j`
<style id="export-pdf-typekit-substitution">
@font-face {
	font-family: "<%=id%>";
	src: url("/fonts/webtype/News Gothic Bold Italic/c6f4e54e-1d69-4559-b813-e2fc4ff29160-3.woff") format("woff"),
		 url("/fonts/webtype/News Gothic Bold Italic/c6f4e54e-1d69-4559-b813-e2fc4ff29160-4.svg#web") format("svg");
	font-style: italic;
	font-weight: 700;
}
@font-face {
	font-family: "<%=id%>";
	src: url("/fonts/webtype/News Gothic Bold/9aab62b7-bc6f-405a-ad75-227bcf89d9dc-3.woff") format("woff"),
		 url("/fonts/webtype/News Gothic Bold/9aab62b7-bc6f-405a-ad75-227bcf89d9dc-4.svg#web") format("svg");
	font-style: normal;
	font-weight: 700;
}
@font-face {
	font-family: "<%=id%>";
	src: url("/fonts/webtype/News Gothic Italic/6327ba72-bfd5-4038-9658-e3a4a95a5c98-3.woff") format("woff"),
		 url("/fonts/webtype/News Gothic Italic/6327ba72-bfd5-4038-9658-e3a4a95a5c98-4.svg#web") format("svg");
	font-style: italic;
	font-weight: 400;
}
@font-face {
	font-family: "<%=id%>";
	src: url("/fonts/webtype/News Gothic/915b0ec4-cd16-40de-883e-1d77c3d07840-3.woff") format("woff"),
		 url("/fonts/webtype/News Gothic/915b0ec4-cd16-40de-883e-1d77c3d07840-4.svg#web") format("svg");
	font-style: normal;
	font-weight: 400;
}
</style>
`,"template-export-pdf-typekit-substitution-georgia-pro":j`
<style id="export-pdf-typekit-substitution">
@font-face {
	font-family: "<%=id%>";
	src: url("/fonts/webtype/Georgia Pro Black/4ec59c91-f66b-4751-8456-e114e9e14673-3.woff") format("woff"),
		 url("/fonts/webtype/Georgia Pro Black/4ec59c91-f66b-4751-8456-e114e9e14673-4.svg#web") format("svg");
	font-style: normal;
	font-weight: 900;
}
@font-face {
	font-family: "<%=id%>";
	src: url("/fonts/webtype/Georgia Pro Bold Italic/6f283590-c3c2-416a-95c2-ca67d04aa929-3.woff") format("woff"),
		 url("/fonts/webtype/Georgia Pro Bold Italic/6f283590-c3c2-416a-95c2-ca67d04aa929-4.svg#web") format("svg");
	font-style: italic;
	font-weight: 700;
}
@font-face {
	font-family: "<%=id%>";
	src: url("/fonts/webtype/Georgia Pro Bold/6f633c58-c751-4d08-9cea-2b27f74f37de-3.woff") format("woff"),
		 url("/fonts/webtype/Georgia Pro Bold/6f633c58-c751-4d08-9cea-2b27f74f37de-4.svg#web") format("svg");
	font-style: normal;
	font-weight: 700;
}
@font-face {
	font-family: "<%=id%>";
	src: url("/fonts/webtype/Georgia Pro Italic/e3bc0ad4-bdaa-4467-82a0-d90f697b7266-3.woff") format("woff"),
		 url("/fonts/webtype/Georgia Pro Italic/e3bc0ad4-bdaa-4467-82a0-d90f697b7266-4.svg#web") format("svg");
	font-style: italic;
	font-weight: 400;
}
@font-face {
	font-family: "<%=id%>";
	src: url("/fonts/webtype/Georgia Pro SemiBold Italic/0e025df5-ba54-4bbb-84b4-c5b337a5b55b-3.woff") format("woff"),
		 url("/fonts/webtype/Georgia Pro SemiBold Italic/0e025df5-ba54-4bbb-84b4-c5b337a5b55b-4.svg#web") format("svg");
	font-style: italic;
	font-weight: 600;
}
@font-face {
	font-family: "<%=id%>";
	src: url("/fonts/webtype/Georgia Pro SemiBold/60fe12ce-0223-4a9a-8e5c-b3e7bd381bc4-3.woff") format("woff"),
		 url("/fonts/webtype/Georgia Pro SemiBold/60fe12ce-0223-4a9a-8e5c-b3e7bd381bc4-4.svg#web") format("svg");
	font-style: normal;
	font-weight: 600;
}
@font-face {
	font-family: "<%=id%>";
	src: url("/fonts/webtype/Georgia Pro/b97bef32-c0cb-4ad3-b724-1204d229731c-3.woff") format("woff"),
		 url("/fonts/webtype/Georgia Pro/b97bef32-c0cb-4ad3-b724-1204d229731c-4.svg#web") format("svg");
	font-style: normal;
	font-weight: 400;
}
</style>
`,"template-export-pdf-typekit-substitution-nitti":j`
<style id="export-pdf-typekit-substitution">
@font-face {
	font-family: "<%=id%>";
	src: url("/fonts/webtype/Nitti Light Italic/15aba0ec-4ceb-49e2-985c-a95134a60aed-3.woff") format("woff"),
		 url("/fonts/webtype/Nitti Light Italic/15aba0ec-4ceb-49e2-985c-a95134a60aed-4.svg#web") format("svg");
	font-style: italic;
	font-weight: 300;
}
@font-face {
	font-family: "<%=id%>";
	src: url("/fonts/webtype/Nitti Light/6fd7c5e9-3131-4cb6-a99e-da74343b1253-3.woff") format("woff"),
		 url("/fonts/webtype/Nitti Light/6fd7c5e9-3131-4cb6-a99e-da74343b1253-4.svg#web") format("svg");
	font-style: normal;
	font-weight: 300;
}
@font-face {
	font-family: "<%=id%>";
	src: url("/fonts/webtype/Nitti Medium/9054f262-2d2d-480f-9360-4560f110243b-3.woff") format("woff"),
		 url("/fonts/webtype/Nitti Medium/9054f262-2d2d-480f-9360-4560f110243b-4.svg#web") format("svg");
	font-style: normal;
	font-weight: 500;
}
</style>
`}});var S,y,nt,et,wt,O,B,Et,bt=H(()=>{"use strict";S=U(at()),y=U(st()),nt=U(Q());ct();ut();pt();tt();lt();gt();yt();ft();dt();ht();rt();et=100,wt=1e4,O=3500,B={STYLE_PREFIXES:{paragraph:{viewer:[".used-fonts-test p",".rmwidget.text div p"],editor:["p"],constructor:[".used-fonts-test p",".block.block-text .text-preview p",".controls .control.text_styles .panel .resizable-scroll-wrapper .resizable-content-wrapper .resizable-content .paragraph-style .style-caption"]},"header-h1":{viewer:[".used-fonts-test h1",".rmwidget.text div h1"],editor:["h1"],constructor:[".used-fonts-test h1",".block.block-text .text-preview h1",".controls .control.text_styles .panel .resizable-scroll-wrapper .resizable-content-wrapper .resizable-content .paragraph-style .style-caption"]},"header-h2":{viewer:[".used-fonts-test h2",".rmwidget.text div h2"],editor:["h2"],constructor:[".used-fonts-test h2",".block.block-text .text-preview h2",".controls .control.text_styles .panel .resizable-scroll-wrapper .resizable-content-wrapper .resizable-content .paragraph-style .style-caption"]},"header-h3":{viewer:[".used-fonts-test h3",".rmwidget.text div h3"],editor:["h3"],constructor:[".used-fonts-test h3",".block.block-text .text-preview h3",".controls .control.text_styles .panel .resizable-scroll-wrapper .resizable-content-wrapper .resizable-content .paragraph-style .style-caption"]},"header-h4":{viewer:[".used-fonts-test h4",".rmwidget.text div h4"],editor:["h4"],constructor:[".used-fonts-test h4",".block.block-text .text-preview h4",".controls .control.text_styles .panel .resizable-scroll-wrapper .resizable-content-wrapper .resizable-content .paragraph-style .style-caption"]},link:{viewer:[".rmwidget.text div a"],editor:["a"],constructor:[".block.block-text .text-preview a"]}},fontsShortList:{},fontCustomVariationNames:{},generateStylesStr:function(o){let n="",i,s,r,p=o.style,f=o.indentation?"	":"",a=";"+(o.lineBreaks?`
`:""),t=o.attrPrefix||"";return o.tp=="paragraph"&&(n+=f+"font-family: "+l("font-family")+a,n+=f+"font-style: "+l("font-style")+a,n+=f+"font-weight: "+l("font-weight")+a,n+=f+"font-size: "+e(l("font-size"))+a,n+=f+"letter-spacing: "+e(l("letter-spacing"))+a,n+=f+"line-height: "+e(l("line-height"))+a,n+=f+"text-align: "+l("text-align")+a,n+=f+"text-decoration: "+l("text-decoration")+a,n+=f+"text-transform: "+l("text-transform")+a,n+=f+"color: "+I.getRGBA(l("color"),l("opacity")/100)+a,n+=f+"padding-top: "+e(l("padding-top"))+a,n+=f+"padding-right: "+e(l("padding-right"))+a,n+=f+"padding-bottom: "+e(l("padding-bottom"))+a,n+=f+"padding-left: "+e(l("padding-left"))+a),o.tp=="link"&&(n+=f+"text-decoration: none"+a,n+=f+"color: "+I.getRGBA(l("color"),l("opacity")/100)+a,l("u-style")!="none"?(i=I.getRGBA(l("u-color"),l("u-opacity")/100),s=parseInt(l("u-size"),10),r=parseInt(l("u-offset"),10)+s,n+=f+"padding-bottom: "+e(Math.max(r,0))+a,l("u-style")=="solid"&&(n+=f+"background: linear-gradient(to right, "+i+" 0%, "+i+" 100%)"+a,n+=f+"background-size: 1px "+e(s)+a),l("u-style")=="dotted"&&(n+=f+"background: linear-gradient(to right, "+i+" 0%, "+i+" 50%, transparent 50%,transparent 100%)"+a,n+=f+"background-size: "+e(s*2)+" "+e(s)+a),l("u-style")=="dashed"&&(n+=f+"background: linear-gradient(to right, "+i+" 0%, "+i+" 66.6666%, transparent 66.6666%,transparent 100%)"+a,n+=f+"background-size: "+e(s*3)+" "+e(s)+a),r<0?n+=f+"background-position: 0 "+(100+r)+"%"+a:n+=f+"background-position: 0 100%"+a,n+=f+"background-repeat: repeat-x"+a):n+=f+"background: none"+a),n;function l(d){let c=p[t+d];return c=="inherit"&&t&&(c=p[d]),c}function e(d){return d+(/px/i.test(d)?"":"px")}},generateCSS:function(o,n,i,s,f){if(!s)return;var p=this.STYLE_PREFIXES[o][n],f=f||{},a=this,t="";y.default.each(s,function(d){o=="paragraph"&&(d.tag&&d.tag!=="p"&&D.AVAILABLE_TEXT_TAGS.includes(d.tag)&&(p=[].concat(a.STYLE_PREFIXES["header-"+d.tag][n],a.STYLE_PREFIXES[o][n]).filter(function(c,m,x){return x.indexOf(c)===m})),t+=y.default.map(p,function(c){return c+"."+d._name}).join(`,
`)+` {
`,t+=a.generateStylesStr({tp:o,style:d,indentation:!0,lineBreaks:!0}),t+=`}

`),o=="link"&&(f.forcePseudoState&&f.forcePseudoClass==d._name?(t+=y.default.map(p,function(c){return c+"."+d._name}).join(`,
`)+` {
`,t+=a.generateStylesStr({tp:o,style:d,attrPrefix:f.forcePseudoState+"-",indentation:!0,lineBreaks:!0}),t+=`}

`):(t+=y.default.map(p,function(m){return m+"."+d._name}).join(`,
`)+` {
`,t+=a.generateStylesStr({tp:o,style:d,indentation:!0,lineBreaks:!0}),t+=`}

`,y.default.find(y.default.keys(d),function(m){return/^current/.test(m)})&&(t+=y.default.map(p,function(m){return m+".current."+d._name}).join(`,
`)+` {
`,t+=a.generateStylesStr({tp:o,style:d,attrPrefix:"current-",indentation:!0,lineBreaks:!0}),t+=`}

`),t+=y.default.map(p,function(m){return m+".hovered."+d._name}).join(`,
`)+` {
`,t+=a.generateStylesStr({tp:o,style:d,attrPrefix:"hover-",indentation:!0,lineBreaks:!0}),t+=`}

`),t+=y.default.map(p,function(c){return c+"."+d._name+" *"}).join(`,
`)+` {
`,t+=`	color: inherit !important;
`,t+=`	text-decoration: none !important;
`,t+=`}

`)}),i=i||document;let l="text_styles_"+o+"_"+n;(0,S.default)("#"+l,i).remove();let e=i.createElement("style");e.type="text/css",e.id=l,e.className="text_styles",e.appendChild(i.createTextNode(t)),i.getElementsByTagName("head")[0].appendChild(e)},appendFontsCssToDocument:function(o,n){window.TypekitPreview&&window.TypekitPreview.setup&&window.TypekitPreview.setup({auth_id:D.TYPEKIT_ID,auth_token:D.TYPEKIT_TOKEN,default_subset:"all"});let i=(0,S.default)("link.fonts, style.fonts"),s=[],r=[],p=[],f={};i.each(function(){let c=(0,S.default)(this),m=c.attr("data-provider"),x=c.attr("data-fonts-and-variations").split("||");y.default.each(x,function(g){s.push(m+"|"+g)})}),y.default.each(o.fonts,function(c){y.default.each(c.used_variations||c.variations,function(m){r.push(c.provider+"|"+c.css_name+"|"+m)})}),p=y.default.difference(r,s);let a={};y.default.each(p,function(c){let m=c.split("|"),x=m[0],g=m[1],k=m[2],h=x+"|"+g;a[h]=a[h]||[],a[h].push(k)});let t=[];y.default.each(a,function(c,m){let x=m.split("|"),g=x[0],k=x[1],h=c;t.push({provider:g,css_name:k,variations:h})}),y.default.each(t,function(c){let m=c.provider,x,g=c.css_name+"|"+c.variations.join("||"+c.css_name+"|");if(f[m]||(f[m]=[]),m=="google"){let k=S.default.map(c.variations,function(h){return(h.substr(1,1)-0)*100+(h.substr(0,1)=="n"?"":"italic")});x={fontAndVariations:g,data:c.css_name.split(" ").join("+")+":"+k.join(",")}}if(m=="webtype"&&(x={fontAndVariations:g,data:c.css_name+":"+c.variations.join(",")}),m=="typetoday"&&(x={fontAndVariations:g,data:c.css_name+":"+c.variations.join(",")}),m=="custom"){let k=y.default.findWhere(o.fonts,{provider:"custom",css_name:c.css_name});k&&k.css_url&&(x={fontAndVariations:g,data:{css_name:c.css_name,css_url:k.css_url,signed_css_url:k.signed_css_url}})}m=="typekit"&&(x={fontAndVariations:g,data:{id:c.css_name,variations:c.variations}}),x&&f[m].push(x)});let l=RM.screenshot&&Y("pdf")=="true";l&&this.loadTypekitSubstitutionFonts(f.typekit);let e=y.default.has(f,"custom");y.default.each(f,function(c,m){let x=m=="custom"?1:m=="google"?22:c.length,g=Math.ceil(c.length/x),k,h,u,w,b,v,_=0;for(k=0;k<g;k++){let N=function(E){E.addClass("fonts").attr("data-id",I.generateUUID()).attr("data-provider",m).attr("data-fonts-and-variations",v.join("||"))};var V=N;if(h=k*x,u=Math.min((k+1)*x,c.length),w=c.slice(h,u),b=y.default.pluck(w,"data"),v=y.default.pluck(w,"fontAndVariations"),(0,S.default)("link, style").addClass("existing"),m=="google"){var F=(D.IS_FILE_PROTOCOL?"http://":"//")+"fonts.googleapis.com/css?family=",L=b.join("%7C"),T="&subset=latin,vietnamese,khmer,cyrillic-ext,greek-ext,greek,devanagari,latin-ext,cyrillic";d(F+L+T)}if(m=="typekit"){if(o.version=="edit"&&!l)try{window.TypekitPreview&&window.TypekitPreview.load(b)}catch{}o.version=="published"&&o.typekit_url&&(typeof Typekit<"u"&&(Typekit=void 0),(0,S.default)("style.typekit-kit").remove(),S.default.getScript(o.typekit_url,function(){try{Typekit.load({active:function(){let E=(0,S.default)("style").filter(function($,ot){return/typekit/i.test(ot.innerHTML)});E.addClass("typekit-kit"),N(E)}})}catch{}}))}let A=D.readymag_viewer_host;if(m=="webtype"){var F=RM.common.isDownloadedSource?A:"";if(!(0,S.default)('link.fonts[data-provider="webtype"]').length){var C=window.ServerData&&window.ServerData.fonts&&window.ServerData.fonts.webtype;d(F+C)}}if(m=="typetoday"&&!l){var F=RM.common.isDownloadedSource?A:"";if(!(0,S.default)('link.fonts[data-provider="typetoday"]').length){var C=window.ServerData&&window.ServerData.fonts&&window.ServerData.fonts.typetoday;d(F+C)}}if(m=="custom"){var P=b[0].signed_css_url||b[0].css_url;/^\/api\/fonts\//i.test(P)?function(){let E=(0,S.default)("<style>").attr("type","text/css");(0,S.default)("head").append(E),S.default.get(P,function($){E.text($),_++,_>=c.length&&y.default.isFunction(n)&&n()})}():d(P)}N((0,S.default)("link:not(.existing), style:not(.existing)")),(0,S.default)("link, style").removeClass("existing")}}),!e&&y.default.isFunction(n)&&n();function d(c){let m=(0,S.default)("<link>").attr("type","text/css").attr("rel","stylesheet").attr("href",c);(0,S.default)("head").append(m)}},loadTypekitSubstitutionFonts:function(o){!o||!o.length||y.default.each(o,function(n){let i=n.data.id,s=y.default.findWhere(B.fontsShortList.typekit,{id:i});s=s&&s.browse_info,s=s&&s.classification;let r=s&&s.length&&s[0]||"sans-serif",p={"sans-serif":"news-gothic",decorative:"news-gothic",handmade:"news-gothic",blackletter:"news-gothic",script:"news-gothic","slab-serif":"news-gothic",serif:"georgia-pro",monospaced:"nitti"},f="template-export-pdf-typekit-substitution-"+(p[r]||p["sans-serif"]),a=Z[f],t=a({id:i});(0,S.default)("head").append(t)})},appendFontsCssToIFrame:function(o){let n=(0,S.default)("link.fonts, style.fonts"),i=(0,S.default)("link.fonts, style.fonts",o),s={},r=(0,S.default)("head",o);i.each(function(){s[(0,S.default)(this).attr("data-id")]=!0}),n.each(function(){let p=(0,S.default)(this),f=this.href;if(!s[p.attr("data-id")]){let a=p.clone();f&&Modernizr.safari&&a.attr("href",f+"&edit_mode=true"),a.appendTo(r)}})},isFastFontLoadCheckAvailable:function(){return!!(document.fonts&&window.Promise)},fastWaitForFontLoad:function(o,n,i){let s;if(document.fonts){let r=i+(n?" "+n:"")+" 12px "+o,p=(l,e)=>{for(let d of document.fonts)if(d.family===l)return d.loaded;return e>Date.now()-O?new Promise(d=>{setTimeout(()=>{d(p(l,e))},50)}):Promise.resolve(!1)},f=!document.fonts.check(r),a=J("viewer.enhancedFontLoadCheck")&&!f?document.fonts.load(r).then(()=>p(o,Date.now())):document.fonts.load(r).then(()=>document.fonts.check(r)?r:this.fontLoadedTimeoutCheck(r)),t=new window.Promise(function(l,e){setTimeout(e.bind(null,r),O)});s=window.Promise.race([a,t])}else s=window.Promise.reject();return s},exactWaitForFontLoad:function(o,n,i,s){let r=i+" "+n+" 12px "+o+", Arial",p=i+" "+n+" 12px Arial",f=20,a=20,t=(0,S.default)('<canvas width="'+f+'" height="'+a+'"></canvas>'),l=t[0],e=l.getContext("2d"),d="",c="",m=+new Date;t.appendTo("body").css({position:"absolute",left:0,top:"-999px"}),x();function x(){let k=+new Date-m>wt,h=g();if(h||k){e=void 0,t.remove(),s(h,o,n,i);return}setTimeout(x,et)}function g(){let k=r;e.clearRect(0,0,f,a),d||(d=l.toDataURL("image/png"),k=p),e.font=k,e.fillStyle="000",e.fillText("a1-&q",0,20);let h=l.toDataURL("image/png");return c||(c=h),h!=d&&h!=c}},fontLoadedTimeoutCheck:function(o){let n=Date.now();var i=function(s,r){let p=Date.now()-n;document.fonts.check(o)?s(o):p<O?setTimeout(i.bind(null,s,r),et):r(o)};return new window.Promise(function(s,r){i(s,r)})},getHotspotTextModels:function(o){let n=[];return o.widgets_collection&&o.widgets_collection.length?n=o.widgets_collection.filter(function(i){return i.get("type")==="text"&&(o.get?o.get("wids"):o.wids).indexOf(i.get("_id"))>-1}):o._nestedWidgetsJSON&&o._nestedWidgetsJSON.length?n=y.default.filter(o._nestedWidgetsJSON,function(i){return i.type==="text"}):o.wids&&o.wids.length&&(n=y.default.filter(o.wids,function(i){return i.type==="text"})),n},getUsedFontsFromWidgetsModels:function(o,n){let i={},s={},r={},p={},f={},a={},t={},l=o.models;function e(h,u){return typeof h.get=="function"?h.get(u):h[u]}let d={bold:700,normal:400};for(let h=0;h<l.length;h++){let u=l[h];if(e(u,"type")==="slideshow"){if(e(u,"version")===2){let w=e(u,"pictures");e(u,"theme_data").captions&&w?.length&&w.forEach(v=>{v.caption?.blocks&&y.default.extend(s,W(v.caption,o.activeViewports))})}else if(e(u,"text_style")){let w=e(u,"text_style"),b=w["font-family"];if(b){let v=w["font-style"]||"normal",_=w["font-weight"]||d.normal;s[b+"|"+v+"|"+_]=1}}}if(e(u,"type")==="button"){let w=e(u,"font-family");if(!e(u,"hidden")&&w){let b=e(u,"font-style")||"normal",v=e(u,"font-weight")||d.normal;r[w+"|"+b+"|"+v]=1}for(let b=0;b<M.viewports.length;b++){let v=u["viewport_"+M.viewports[b].name]||{},_=v["font-family"];if(_&&!v.hidden){let F=v["font-style"]||"normal",L=v["font-weight"]||d.normal;r[_+"|"+F+"|"+L]=1}}}if(e(u,"type")==="ecommercecart"){let w=e(u,"font-family");if(w){let v=e(u,"font-style")||"normal",_=e(u,"font-weight")||d.normal;f[w+"|"+v+"|"+_]=1}let b=e(u,"bar-font-family");if(b){let v=e(u,"bar-font-style")||"normal",_=e(u,"bar-font-weight")||d.normal;f[b+"|"+v+"|"+_]=1}}if(e(u,"type")==="addtocart"){let w=e(u,"font-family");if(w){let v=e(u,"font-style")||"normal",_=e(u,"font-weight")||d.normal;a[w+"|"+v+"|"+_]=1}let b=e(u,"attrs-font-family");if(b){let v=e(u,"attrs-font-style")||"normal",_=e(u,"attrs-font-weight")||d.normal;a[b+"|"+v+"|"+_]=1}}if(e(u,"type")==="form"){if(!e(u,"hidden")){let w=e(u,"style"),b=e(u,"style-"+w+"-fields")||{},{"font-family":v,"font-style":_="normal","font-weight":F=d.normal}=b;v&&(p[v+"|"+_+"|"+F]=1);let L=e(u,"style-"+w+"-button-default")||{},{"font-family":T,"font-style":C="normal","font-weight":P=d.normal}=L;T&&(T=T==="inherit"?v:T,C=C==="inherit"?_:C,P=P==="inherit"?F:P,p[T+"|"+C+"|"+P]=1)}for(let w=0;w<M.viewports.length;w++){let b=u["viewport_"+M.viewports[w].name];if(b&&!b.hidden){let v=b.style||e(u,"style"),_=b["style-"+v+"-fields"]||e(u,"style-"+v+"-fields")||{},{"font-family":F,"font-style":L="normal","font-weight":T=d.normal}=_;F&&(p[F+"|"+L+"|"+T]=1);let C=b["style-"+v+"-button-default"]||{},{"font-family":P,"font-style":V="normal","font-weight":A=d.normal}=C;P&&(P=P==="inherit"?F:P,V=V==="inherit"?L:V,A=A==="inherit"?T:A,p[P+"|"+V+"|"+A]=1)}}}if(e(u,"type")==="text"&&e(u,"version")===3){e(u,"hidden")||y.default.extend(i,W(u,o.activeViewports));for(let w=0;w<M.viewports.length;w++){let b=u["viewport_"+M.viewports[w].name];b&&!b.hidden&&y.default.extend(i,W({blocks:e(u,"blocks"),...b},o.activeViewports))}}if(e(u,"type")==="text"&&e(u,"text")&&e(u,"version")!==3&&y.default.extend(i,this.scanTextForFontsAndVariationsRaw(e(u,"text"),e(u,"version"),o.excludeUnusedDefault,o.activeViewports)),e(u,"type")==="hotspot"&&y.default.each(this.getHotspotTextModels(u),y.default.bind(function(w){e(w,"version")===3?y.default.extend(i,W(w,o.activeViewports)):e(w,"text")&&y.default.extend(i,this.scanTextForFontsAndVariationsRaw(e(w,"text"),e(w,"version"),o.excludeUnusedDefault))},this)),e(u,"type")==="video"){let w=typeof u.get=="function"&&u.attributes?u.attributes:u;X(w,(b={})=>{let v=b?.custom_controls??{},_=b?.controls_type,{type:F,fontFamily:L=R.fontFamily,fontStyle:T=R.fontStyle,fontWeight:C=R.fontWeight}=v;_==="custom"&&F==="Text"&&(t[L+"|"+T+"|"+C]=1)})}}let c=y.default.extend({},i,s,r,p,f,a,t),m={};if(o.onlyFontsNames){let h=[];return y.default.each(c,(u,w)=>{let b=w.split("|"),v=b[0];v&&h.push(v)}),h}y.default.each(c,function(h,u){let w=u.split("|"),b=w[0],v=w[1].toLowerCase(),_=w[2].toLowerCase(),F=_ in d?d[_]:_;m[b]=m[b]||[],m[b].push(F==="variable"?"v":(v==="italic"?"i":"n")+Math.floor(F/100))});let x=[],g,k=this;return y.default.each(m,function(h,u){(g=y.default.findWhere(n.webtype,{name:u}))?x.push({provider:"webtype",css_name:g.name,name:g.name,variations:g.variations,used_variations:k.calcBrowserUsedVariation(h,g.variations)}):(g=y.default.findWhere(n.typetoday,{name:u}))?x.push({provider:"typetoday",css_name:g.name,name:g.name,variations:g.variations,used_variations:k.calcBrowserUsedVariation(h,g.variations)}):(g=y.default.findWhere(n.google,{family:u}))?x.push({provider:"google",css_name:g.family,name:g.family,variations:g.variations,used_variations:k.calcBrowserUsedVariation(h,g.variations)}):(g=y.default.findWhere(n.typekit,{id:u}))?x.push({provider:"typekit",css_name:g.id,name:g.name,variations:g.variations,used_variations:k.calcBrowserUsedVariation(h,g.variations)}):o.includeCustom&&(g=y.default.findWhere(o.customList,{css_name:u}))&&x.push({provider:"custom",css_name:g.css_name,css_url:g.css_url,name:g.name,variations:g.variations,used_variations:k.calcBrowserUsedVariation(h,g.variations)})}),x.filter(h=>h.used_variations&&h.used_variations.length>0)},convertToFVD:function(o,n){let i=o==="italic"?"i":"n",s=!Number.isNaN(n)&&Number(n)>0?Math.floor(n/100):null;return i&&s?i+s:null},mapFontFamilyToProvider:function(o={},n={}){let i=["google","typekit","typetoday"],s=K(o),r=[],p=(f=[],a=[])=>{let t=f.length,l=[];for(let e=0;e<t;e++){let d=f[e],c=a[e],m=this.convertToFVD(d,c);m&&l.push(m)}return l};for(let f of i)if(n[f])for(let a of n[f]){let t=null,l=null;f==="google"?(t=a.family,l=t):f==="typekit"?(t=a.name,l=a.id):f==="typetoday"&&(t=a.name,l=t);let e=t||l;if(s[e]){let d=s[e],c=p(d.fontStyle,d.fontWeight);r.push({provider:f,css_name:l,name:t,variations:a.variations,used_variations:this.calcBrowserUsedVariation(c,a.variations)}),delete s[e]}}return{processedFonts:r,unprocessedFonts:s}},getStylesFromText3Model:function(o,n){function i(r,p){return typeof r.get=="function"?r.get(p):r[p]}let s=new Set;if(n==="link"&&i(o,"entityMap")){let r=i(o,"entityMap");y.default.isEmpty(r)||y.default.each(r,p=>{p.type==="LINK"&&p.data?.linkStyle&&s.add(p.data?.linkStyle)})}else if(i(o,"blocks")&&i(o,"blocksMeta")){let r=i(o,"blocks")||[],p=i(o,"blocksMeta");r.forEach(f=>{let t=(p?p.find(e=>e.key===f.key):f)?.data,l=n==="paragraph"?"textStyle":"listStyle";t?.[l]&&s.add(t[l])})}return s},getStylesFromText:function(o="",n){let i=new Set,s=n||RM.constructorRouter.workspace.mag.edit_params.get("paragraph_styles");if(o)for(let r=0;r<s.length;r++){let p=s[r];o.indexOf(p._name)>=0&&i.add(p)}return i},getUsedStylesFromWidgetsModels:function(o,n="paragraph",i=!1){let s=n==="paragraph"?RM.constructorRouter.workspace.mag.edit_params.get("paragraph_styles"):n==="list"?q()?.project:[],r=new Set,p="";function f(a,t){return typeof a.get=="function"?a.get(t):a[t]}for(let a=0;a<o.length;a++){let t=o[a];if(f(t,"type")==="text"&&f(t,"version")===3){let l=this.getStylesFromText3Model(t,n);l.size&&l.forEach(e=>r.add(e)),M.viewports.forEach(e=>{let d=`viewport_${e.name}`;if(t[d]?.blocksMeta){let c=t[d].blocks||f(t,"blocks"),m=this.getStylesFromText3Model({...t[d],blocks:c},n);m.size&&m.forEach(x=>r.add(x))}})}if(!i&&f(t,"type")==="text"&&f(t,"version")!==3&&f(t,"text")&&(p+=f(t,"text")),f(t,"type")==="slideshow"&&f(t,"version")===2){let l=f(t,"pictures");l?.length&&l.forEach(e=>{if(e.caption?.blocks&&e.caption?.blocksMeta){let d=this.getStylesFromText3Model(e.caption,n);d.size&&d.forEach(c=>r.add(c))}})}f(t,"type")==="hotspot"&&y.default.each(this.getHotspotTextModels(t),l=>{if(f(l,"version")===3){let e=this.getStylesFromText3Model(l,n);e.size&&e.forEach(d=>r.add(d))}else!i&&f(l,"text")&&(p+=f(l,"text"))})}if(!i){let a=this.getStylesFromText(p,s);a.size&&a.forEach(t=>r.add(t))}return r},getUsedParagraphStylesFromWidgetsModels:function(o,n){let i="",s,r;for(s=0;s<o.length;s++)r=o[s],a(r,"type")=="text"&&a(r,"text")&&(i+=a(r,"text")),a(r,"type")=="hotspot"&&y.default.each(this.getHotspotTextModels(r),y.default.bind(function(t){i+=a(t,"text")||""},this));let p=[],f=n.edit_params.get("paragraph_styles");if(i)for(s=0;s<f.length;s++){let t=f[s];i.indexOf(t._name)>=0&&p.push(t)}function a(t,l){return typeof t.get=="function"?t.get(l):t[l]}return p},getUsedLinkStylesFromWidgetsModels:function(o,n){let i="",s,r;for(s=0;s<o.length;s++)r=o[s],a(r,"type")=="text"&&a(r,"text")&&(i+=a(r,"text")),a(r,"type")=="hotspot"&&y.default.each(this.getHotspotTextModels(r),y.default.bind(function(t){i+=a(t,"text")||""},this));let p=[],f=n.edit_params.get("link_styles");if(i)for(s=0;s<f.length;s++){let t=f[s];i.indexOf(t._name)>=0&&p.push(t)}function a(t,l){return typeof t.get=="function"?t.get(l):t[l]}return p},sortFontsByProvider(o){let n={custom:[],google:[],typekit:[],typetoday:[],webtype:[]};for(let i of o){let s=i.provider;n[s]=n[s]||[],i.provider==="custom"?n[s].push(i.css_name):n[s].push({id:i.css_name,variations:i.used_variations})}return{used_custom_fonts:n.custom,used_google_fonts:n.google,used_typekit_fonts:n.typekit,used_typetoday_fonts:n.typetoday,used_webtype_fonts:n.webtype}},scanTextForFontsAndVariationsRaw:function(o,n,i,s){let r={},p={},f=[],a=document.defaultView.getComputedStyle,t,l,e,d,c,m,x,g,k,h,u;for(t=0;t<M.viewports.length;t++)if(o.split("-"+M.viewports[t].name).length>1){if(s&&s.indexOf(M.viewports[t].name)===-1)continue;f.push(M.viewports[t].name)}e=(0,S.default)(".used-fonts-test"),e.length||(e=(0,S.default)("<div>").addClass("used-fonts-test").css({position:"absolute",display:"none !important",left:-9999,width:999}).appendTo("body")),e.removeClass("v1 v2").addClass("v"+(n||1)),l=e[0],l.innerHTML=o,m=l.querySelectorAll("span,p,a"),x=m.length,c=a(l,null);let w=c.fontFamily+"|"+c.fontStyle+"|"+c.fontWeight;r[w]=1;let b,v=!1,_=function(T){return y.default.findIndex(T.childNodes,function(C){return C.nodeType===Node.TEXT_NODE&&C.textContent.replace(/\r?\n/g,"").length})!==-1},F=y.default.filter(m,_);for(let T=0;T<F.length;T++)c=a(F[T],null),b=c.fontFamily+"|"+c.fontStyle+"|"+c.fontWeight,v=v||b===w,r[c.fontFamily+"|"+c.fontStyle+"|"+c.fontWeight]=1;let L=_(l);for(t=0;t<f.length;t++)if(h=f[t],h!="default"){for(d=0;d<x;d++)u=m[d],(g=u.getAttribute("data-style-"+h))&&(g=="empty"?u.removeAttribute("style"):u.setAttribute("style",g)),(k=u.getAttribute("data-class-"+h))&&(k=="empty"?u.removeAttribute("class"):u.setAttribute("class",k)),_(u)&&(c=a(u,null),b=c.fontFamily+"|"+c.fontStyle+"|"+c.fontWeight,v=v||b===w,r[b]=1);t<f.length-1&&(l.innerHTML=o,m=l.querySelectorAll("span,p,a"),x=m.length)}return i&&!v&&!L&&delete r[w],y.default.each(r,function(T,C){let P=C.split("|"),V=P[0],A=P[1].toLowerCase(),N=P[2].toLowerCase();V=V.split(",")[0],V=V.replace(/'|"/g,""),N=N.replace(/normal/g,"400"),N=N.replace(/regular/g,"400"),N=N.replace(/bold/g,"700"),p[V+"|"+A+"|"+N]=1}),p},calcBrowserUsedVariation:function(o,n){let i={};for(let d=0;d<o.length;d++){var s=o[d],r=s.substr(1,1),p=s.substr(0,1),f=99999,a="",t,l,e;for(let c=0;c<n.length;c++)t=n[c].substr(1,1)-0,l=n[c].substr(0,1),r<4&&(e=Math.abs(t-r)*10+(l==p?0:1e3)+(t<=r?0:100)),r>5&&(e=Math.abs(t-r)*10+(l==p?0:1e3)+(t>=r?0:100)),r==4&&(t==5?e=0+(l==p?0:1e3)+0:e=Math.abs(t-r)*10+(l==p?0:1e3)+(t<=r?0:100)),r==5&&(e=Math.abs(t-r)*10+(l==p?0:1e3)+(t<=r?0:100)),r==t&&p==l&&(e=0),e<f&&(f=e,a=n[c]);i[a]=1}return y.default.keys(i).filter(d=>!!d)},getVeryShortList:function(o){let n={google:[],typekit:[],webtype:[],typetoday:[]};return y.default.each(o,function(i){let s=i.provider,r;switch(s){case"google":r={provider:s,family:i.name,variations:i.variations};break;case"typekit":r={provider:s,id:i.css_name,name:i.name,variations:i.variations};break;case"webtype":r={provider:s,name:i.name,variations:i.variations};break;case"typetoday":r={provider:s,name:i.name,variations:i.variations};break}n[s]&&n[s].push(r)}),n},getCustomVariationNameByFVD:function(o,n){return(B.fontCustomVariationNames[o]||{})[n]},setShortList:function(o){B.fontsShortList=o||{},B.fontCustomVariationNames={},y.default.each(B.fontsShortList,function(n,i){y.default.each(n,function(s){if(s.custom_variation_names){let r;switch(i){case"google":r=s.family;break;case"typekit":case"webtype":case"typetoday":r=s.name;break}B.fontCustomVariationNames[r]=s.custom_variation_names}})})},preloadShortList:async function(){let o=new Date,n=o.getDate()+"-"+(o.getMonth()+1)+"-"+o.getFullYear();try{let i=await(0,nt.default)(`${D.fontslist_short}?timestamp=${n}`,{jsonpCallback:"callback",jsonpCallbackFunction:"fontsShortListCallback"}).then(s=>s.json());B.setShortList(i)}catch{console.error("Cannot preload fontslist")}}},Et=B});export{Et as a,bt as b};
